<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>马树菌的博客驿站</title>
  
  <subtitle>https://api.gushi.ci/all.png</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://lesliewong.cn/"/>
  <updated>2019-03-22T17:00:05.538Z</updated>
  <id>http://lesliewong.cn/</id>
  
  <author>
    <name>爱冒泡的马树菌</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>借助诗词API和微博图床搭建自动发图文微博机器人</title>
    <link href="http://lesliewong.cn/2019/03/15/build-a-weibo-bot-with-some-data-api/"/>
    <id>http://lesliewong.cn/2019/03/15/build-a-weibo-bot-with-some-data-api/</id>
    <published>2019-03-15T12:45:30.000Z</published>
    <updated>2019-03-22T17:00:05.538Z</updated>
    
    <content type="html"><![CDATA[<p>​    在2011年的时候，浙大的一位博士生借助微博的开放平台为他实验室的一台饮水机弄了个微博，名唤@浙大CCNT实验室饮水机，俗称“饮水机娘“。当年自己对这条新闻留下了挺深的印象，也一直对这个微博账号可以自动发微博背后的机理感到十分憧憬。一晃，时间都来到了2019年了~~</p><p>​    咳咳——在钻研不少技术文章以及对技术派网友的多多请教后，自己终于也捣弄了一个自动发微博的机器人(￣︶￣)↗</p><a id="more"></a><hr><p>​    此微博机器人的功能如下：</p><ul><li>直接模拟登陆新浪微博；</li><li>自动获取唐诗宋词文本；</li><li>自动获取文艺主题图片；</li><li>自动上传图片至微博图床；</li><li>自动发送内容不同的图文微博；</li><li>通过定时任务，实现周期性发微博任务。</li></ul><hr><p>​    实际效果图：</p><p><img src="https://ws1.sinaimg.cn/large/006vCcQDgy1g13zken7kgj30qn0l50xq.jpg" alt="">    </p><p>​    GitHub仓库：</p><blockquote><p><a href="https://github.com/Leslie-Wong-H/weiboPoemBot" target="_blank" rel="noopener">https://github.com/Leslie-Wong-H/weiboPoemBot</a></p></blockquote><p>​    正所谓“前不见古人，后不见来者。念天地之悠悠，独怆然而涕下！“，咳咳——IT技术世界当然不是这样，我们的技术积累都是站在前人的基础上的，换言之，站在巨人的肩膀上。所以，还是先来啰嗦啰嗦当年的饮水机娘。</p><h2 id="饮水机娘分析"><a href="#饮水机娘分析" class="headerlink" title="饮水机娘分析"></a>饮水机娘分析</h2><p>​    当年果壳网在饮水机娘爆红了的时候，采访了背后的开发者——浙江大学计算机科学与技术学院的一位陈姓博士生。文章标题是<a href="https://www.guokr.com/article/81621/" target="_blank" rel="noopener">《揭开“饮水机娘”的神秘面纱》</a>。在这篇文章中，阐述发微博原理的段落如下：</p><blockquote><p>据陈同学介绍，饮水机本身并没有多加改造，只是饮水机上安装一个摄像头，镜头正对加热指示灯，作为传感器，实时监控加热状态。</p><p>发送微博的功能通过代码实现，利用了新浪微博开放平台提供的PHP语言软件开发工具包。在代码的设计中，主要有检测模块和反应模块两部分。检测模块处理摄像头的监控数据，捕捉加热指示灯“亮-&gt;不亮”与“不亮-&gt;亮”两个切换状态，然后调用反应模块及时发送微博。所以在“饮水机娘”自动发送的微博下方，会显示“来自未通过审核应用”。目前，完成这些功能，所需的代码量不足两百行。</p></blockquote><p>​    现在来分析分析这两段话，把整个流程弄成流程图的话是如下的效果：</p><p><img src="https://ws1.sinaimg.cn/large/006vCcQDgy1g13zj5qy1sj30yh0cndh8.jpg" alt=""></p><p>​    从“指示灯”到“视觉算法判断状态”这部分属于计算机视觉实现了，依本人目前的技术视野判断，可以借助openCV来构建。至于发送微博这一部分，则是纯粹的PHP代码实现。由于本文所要讨论的是构建一个发微博的机器人，而微博报文数据的获取可以有很多种方式，因此，openCV就点到为止了。（自己也不是太懂openCV）(。・_・)/~~~</p><p>​    自己在查阅了不少技术文献后，通过这篇<a href="https://www.cnblogs.com/chasewade/p/3408086.html" target="_blank" rel="noopener">《新浪微博自动（模拟）登陆详解及实现》</a>了解到饮水机娘发送的微博下方会出现“来自未通过审核应用”是由于用了新浪微博开放平台的接口的缘故，而且其会有几个比较致命的限制（调用次数限制和授权期限限制）。网上流传一种直接模拟登陆微博的解决方案，关键点就是利用php的curl功能，这也是本人所要阐述的微博机器人使用的登录原理。</p><p>​    另外，翻了翻饮水机娘最早期发送的微博，报告饮水机水沸腾了的微博报文是这样子的——</p><p><img src="https://i.loli.net/2019/03/15/5c8bafa625e44.png" alt="1552649398204"></p><p>​    后来变成了这样子——</p><p><img src="https://i.loli.net/2019/03/15/5c8bafa6303d1.png" alt=""></p><p>​    而对应“亮-&gt;不亮”状态的微博报文最初是这样子的——</p><p><img src="https://i.loli.net/2019/03/15/5c8bafa643929.png" alt=""></p><p>​    不过，后来关注度上去之后，就很难判断饮水机娘发送的微博是不是根据饮水机状态自动发出去了的了，但是也不影响本文后续的叙述。OK，溯源的部分就到这里，接下来讲讲在机器人构建中占据不少分量的数据获取API——今日诗词API、文艺主题图片API、微博图床API。</p><h2 id="今日诗词API"><a href="#今日诗词API" class="headerlink" title="今日诗词API"></a>今日诗词API</h2><p>​    今日诗词API是<a href="https://luan.ma" target="_blank" rel="noopener">乱码</a>开发的一个可以返回一句古诗词名句的接口。它可以通过图片和JSON格式调用。今日诗词API根据不同地点、时间、节日、季节、天气、景观、城市、事件进行智能推荐。</p><p>​    官方文档地址是<a href="https://www.jinrishici.com/，" target="_blank" rel="noopener">https://www.jinrishici.com/，</a> 乱码大佬撰写的介绍文章则是<a href="https://luan.ma/post/jinrishici/。就本人所要构建的微博机器人而言，使用到的接口是" target="_blank" rel="noopener">https://luan.ma/post/jinrishici/。就本人所要构建的微博机器人而言，使用到的接口是</a><a href="https://v2.jinrishici.com/one.json" target="_blank" rel="noopener">https://v2.jinrishici.com/one.json</a>，而且是使用带token的调用方式。</p><h2 id="文艺主题图片API"><a href="#文艺主题图片API" class="headerlink" title="文艺主题图片API"></a>文艺主题图片API</h2><p>​    这个图片API是<a href="https://www.yuluoge.com/" target="_blank" rel="noopener">九凌少子</a>负责开发的，他的图源来自于360壁纸，主要功能就是根据调用需求，返回一张360壁纸的官方服务器上的图片URL。调用方式如下：</p><blockquote><p><a href="https://www.yuluoge.com/api/index.php?cid=5" target="_blank" rel="noopener">https://www.yuluoge.com/api/index.php?cid=5</a></p></blockquote><p>​    不同的cid值对应不同的分类，根据他的解释及本人测试，分类如下——</p><ul><li>cid=0 —— 默认图片，不分类型</li><li>cid=1 —— 美女</li><li>cid=2 —— 动漫</li><li>cid=3 —— 风景</li><li>cid=4 —— 游戏</li><li>cid=5 —— 文艺</li><li>cid=6 —— 文字控</li><li>cid=7 —— 动物</li><li>cid=8 —— 爱情</li></ul><p>​    此外，这篇文章最后贴出来的源代码是基于他在今日诗词的Q群里分享的发微博源码改造而来的，在此感谢他的贡献。</p><h2 id="微博图床API"><a href="#微博图床API" class="headerlink" title="微博图床API"></a>微博图床API</h2><p>​    对于微博图床API的理解得力于这篇文章——<a href="https://cloud.tencent.com/developer/article/1147512" target="_blank" rel="noopener">《利用微博当图床-php语言实现》</a>。</p><p>​    使用到的微博图片上传接口为</p><blockquote><p><a href="http://picupload.service.weibo.com/interface/pic_upload.php" target="_blank" rel="noopener">http://picupload.service.weibo.com/interface/pic_upload.php</a></p></blockquote><p>​    本文所构建机器人略有改动地使用了这篇文章里的获取新浪图床图片pid的PHP源码。源码如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 上传图片到微博图床</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> mengkun  http://mkblog.cn</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $file 图片文件/图片url</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $multipart 是否采用multipart方式上传</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 返回的json数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload</span><span class="params">($file, $multipart = true)</span> </span>&#123;</span><br><span class="line">    $cookie = <span class="string">''</span>;    <span class="comment">// 微博cookie</span></span><br><span class="line">    $url = <span class="string">'http://picupload.service.weibo.com/interface/pic_upload.php'</span></span><br><span class="line">    .<span class="string">'?mime=image%2Fjpeg&amp;data=base64&amp;url=0&amp;markpos=1&amp;logo=&amp;nick=0&amp;marks=1&amp;app=miniblog'</span>;</span><br><span class="line">    <span class="keyword">if</span>($multipart) &#123;</span><br><span class="line">        $url .= <span class="string">'&amp;cb=http://weibo.com/aj/static/upimgback.html?_wv=5&amp;callback=STK_ijax_'</span>.time();</span><br><span class="line">        <span class="keyword">if</span> (class_exists(<span class="string">'CURLFile'</span>)) &#123;     <span class="comment">// php 5.5</span></span><br><span class="line">            $post[<span class="string">'pic1'</span>] = <span class="keyword">new</span> CURLFile(realpath($file));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $post[<span class="string">'pic1'</span>] = <span class="string">'@'</span>.realpath($file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $post[<span class="string">'b64_data'</span>] = base64_encode(file_get_contents($file));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Curl提交</span></span><br><span class="line">    $ch = curl_init($url);</span><br><span class="line">    curl_setopt_array($ch, <span class="keyword">array</span>(</span><br><span class="line">        CURLOPT_POST =&gt; <span class="keyword">true</span>,</span><br><span class="line">        CURLOPT_VERBOSE =&gt; <span class="keyword">true</span>,</span><br><span class="line">        CURLOPT_RETURNTRANSFER =&gt; <span class="keyword">true</span>,</span><br><span class="line">        CURLOPT_HTTPHEADER =&gt; <span class="keyword">array</span>(<span class="string">"Cookie: $cookie"</span>),</span><br><span class="line">        CURLOPT_POSTFIELDS =&gt; $post,</span><br><span class="line">    ));</span><br><span class="line">    $output = curl_exec($ch);</span><br><span class="line">    curl_close($ch);</span><br><span class="line">    <span class="comment">// 正则表达式提取返回结果中的json数据</span></span><br><span class="line">    preg_match(<span class="string">'/(&#123;.*)/i'</span>, $output, $match);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>($match[<span class="number">1</span>])) <span class="keyword">return</span> <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">return</span> $match[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="微博机器人源码"><a href="#微博机器人源码" class="headerlink" title="微博机器人源码"></a>微博机器人源码</h2><p>​    列举了所要用到的几个重要API，最后还是贴一下机器人的源码吧。当然，也有相对应的GitHub仓库<a href="https://github.com/Leslie-Wong-H/weiboPoemBot" target="_blank" rel="noopener">https://github.com/Leslie-Wong-H/weiboPoemBot</a></p><p><strong>主模块</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//weibo.php</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">'./weiboLogin.php'</span>;</span><br><span class="line">header(<span class="string">"Content-type: text/html; charset=utf-8"</span>);</span><br><span class="line">header(<span class="string">"Access-Control-Allow-Origin:*"</span>);</span><br><span class="line">header(<span class="string">'Content-type: application/json'</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">发送微博</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curl</span><span class="params">($url,$post=<span class="number">0</span>,$header=<span class="number">0</span>,$cookie=<span class="number">0</span>,$referer=<span class="number">0</span>,$ua=<span class="number">0</span>,$nobody=<span class="number">0</span>)</span></span>&#123;</span><br><span class="line">$ch = curl_init();</span><br><span class="line">curl_setopt($ch, CURLOPT_URL,$url);</span><br><span class="line">curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">false</span>);</span><br><span class="line">curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="keyword">false</span>);</span><br><span class="line">$httpheader[] = <span class="string">"Accept:*/*"</span>;</span><br><span class="line">$httpheader[] = <span class="string">"Accept-Encoding:gzip,deflate,sdch"</span>;</span><br><span class="line">$httpheader[] = <span class="string">"Accept-Language:zh-CN,zh;q=0.8"</span>;</span><br><span class="line">$httpheader[] = <span class="string">"Connection:close"</span>;</span><br><span class="line">curl_setopt($ch, CURLOPT_HTTPHEADER, $httpheader);</span><br><span class="line"><span class="keyword">if</span>($post)&#123;</span><br><span class="line">curl_setopt($ch, CURLOPT_POST, <span class="number">1</span>);</span><br><span class="line">curl_setopt($ch, CURLOPT_POSTFIELDS, $post);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($header)&#123;</span><br><span class="line">curl_setopt($ch, CURLOPT_HEADER, <span class="keyword">TRUE</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($cookie)&#123;</span><br><span class="line">curl_setopt($ch, CURLOPT_COOKIE, $cookie);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($referer)&#123;</span><br><span class="line">curl_setopt($ch, CURLOPT_REFERER, $referer);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($ua)&#123;</span><br><span class="line">curl_setopt($ch, CURLOPT_USERAGENT,$ua);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">curl_setopt($ch, CURLOPT_USERAGENT,<span class="string">'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.167 Safari/537.36'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($nobody)&#123;</span><br><span class="line">curl_setopt($ch, CURLOPT_NOBODY,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">curl_setopt($ch, CURLOPT_ENCODING, <span class="string">"gzip"</span>);</span><br><span class="line">curl_setopt($ch, CURLOPT_RETURNTRANSFER,<span class="number">1</span>);</span><br><span class="line">$ret = curl_exec($ch);</span><br><span class="line">curl_close($ch);</span><br><span class="line"><span class="keyword">return</span> $ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 上传图片到微博图床</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> mengkun http://mkblog.cn</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $file 图片文件/图片url</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $multipart 是否采用multipart方式上传</span></span><br><span class="line"><span class="comment"> * return 返回的json数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload</span><span class="params">($file, $cookie, $multipart = true)</span></span>&#123;</span><br><span class="line">$url = <span class="string">'http://picupload.service.weibo.com/interface/pic_upload.php'</span>.<span class="string">'?mime=image%2Fjpeg&amp;data=base64&amp;url=0&amp;markpos=1&amp;logo=&amp;nick=0&amp;marks=1&amp;app=miniblog'</span>;</span><br><span class="line"><span class="keyword">if</span>($multipart)&#123;</span><br><span class="line">$url .= <span class="string">'&amp;cb=http://weibo.com/aj/static/upimgback.html?_wv=5&amp;callback=STK_ijax_'</span>.time();</span><br><span class="line"><span class="keyword">if</span>(class_exists(<span class="string">'CURLFile'</span>))&#123;<span class="comment">//php 5.5</span></span><br><span class="line">$post[<span class="string">'pic1'</span>] = <span class="keyword">new</span> CURLFile(realpath($file));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">$post[<span class="string">'pic1'</span>] = <span class="string">'@'</span>.realpath($file);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">$post[<span class="string">'b64_data'</span>] = base64_encode(file_get_contents($file));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// echo $post['b64_data'];</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Curl 提交</span></span><br><span class="line">$ch = curl_init($url);</span><br><span class="line">curl_setopt_array($ch, <span class="keyword">array</span>(</span><br><span class="line">CURLOPT_POST =&gt; <span class="keyword">true</span>,</span><br><span class="line">CURLOPT_VERBOSE =&gt; <span class="keyword">true</span>,</span><br><span class="line">CURLOPT_RETURNTRANSFER =&gt; <span class="keyword">true</span>,</span><br><span class="line">CURLOPT_HTTPHEADER =&gt; <span class="keyword">array</span>(<span class="string">"Cookie: $cookie"</span>),</span><br><span class="line">CURLOPT_POSTFIELDS =&gt; $post,</span><br><span class="line">));</span><br><span class="line"></span><br><span class="line">$output = curl_exec($ch);</span><br><span class="line">curl_close($ch);</span><br><span class="line"><span class="comment">// 正则表达式提取返回结果中的json数据</span></span><br><span class="line"></span><br><span class="line">preg_match(<span class="string">'/(&#123;.*)/i'</span>, $output, $match);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($match[<span class="number">1</span>])) <span class="keyword">return</span> <span class="string">''</span>;</span><br><span class="line"><span class="keyword">return</span> $match[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  通过今日诗词API获取诗词内容</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">jinrishici</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    $opts = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">'http'</span>=&gt;<span class="keyword">array</span>(</span><br><span class="line">        <span class="string">'method'</span>=&gt;<span class="string">"GET"</span>,</span><br><span class="line">        <span class="string">'header'</span>=&gt;<span class="string">"Accept-language: en\r\n"</span>.<span class="string">"X-User-Token: k4z4CMgTyl3JN6s+y2iWWiHN6we+0J9V\r\n"</span></span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line">    $context = stream_context_create($opts);</span><br><span class="line">    <span class="comment">// Open the file using the HTTP headers set above</span></span><br><span class="line">    $tangshi_pailie = json_decode(file_get_contents(<span class="string">'https://v2.jinrishici.com/one.json'</span>, <span class="keyword">false</span>, $context),<span class="keyword">true</span>);          <span class="comment">//今日诗词API，带token版本</span></span><br><span class="line">   </span><br><span class="line">    <span class="comment">// $tangshi_pailie = json_decode(file_get_contents('https://v2.jinrishici.com/one.json'), true);                  //今日诗词api,不带token版本</span></span><br><span class="line"></span><br><span class="line">    $tangshi_title = $tangshi_pailie[<span class="string">'data'</span>][<span class="string">'origin'</span>][<span class="string">'title'</span>];              <span class="comment">//标题</span></span><br><span class="line">    $tangshi_dynasty = $tangshi_pailie[<span class="string">'data'</span>][<span class="string">'origin'</span>][<span class="string">'dynasty'</span>];          <span class="comment">//朝代</span></span><br><span class="line">    $tangshi_author = $tangshi_pailie[<span class="string">'data'</span>][<span class="string">'origin'</span>][<span class="string">'author'</span>];            <span class="comment">//诗人</span></span><br><span class="line">    </span><br><span class="line">    $tangshi_line_numbers = count($tangshi_pailie[<span class="string">'data'</span>][<span class="string">'origin'</span>][<span class="string">'content'</span>]);</span><br><span class="line">    $tangshi_content = $tangshi_pailie[<span class="string">'data'</span>][<span class="string">'origin'</span>][<span class="string">'content'</span>][<span class="number">0</span>];  </span><br><span class="line">    <span class="keyword">for</span> ($i=<span class="number">1</span>; $i &lt; $tangshi_line_numbers; $i++) &#123; </span><br><span class="line">      $tangshi_temp_line = $tangshi_pailie[<span class="string">'data'</span>][<span class="string">'origin'</span>][<span class="string">'content'</span>][$i];  </span><br><span class="line">        $tangshi_content = $tangshi_content.<span class="string">"\n"</span>.$tangshi_temp_line;      </span><br><span class="line">    &#125;                                 <span class="comment">//拼接全诗</span></span><br><span class="line"></span><br><span class="line">    $post_Poem = <span class="string">"《"</span>.$tangshi_title.<span class="string">"》"</span>.<span class="string">"\n"</span>.$tangshi_dynasty.<span class="string">"·"</span>.$tangshi_author.<span class="string">"\n"</span>.<span class="string">"\n"</span>.$tangshi_content;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> <span class="string">"$post_Poem"</span>;</span><br><span class="line">&#125;  </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">include</span> <span class="string">'./wbcookie.php'</span>;</span><br><span class="line">    $cookie = $config[<span class="string">'cookie'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//通过图片api获取图片，并转存微博图床</span></span><br><span class="line">    $bing_img = json_decode(upload(<span class="string">'https://www.yuluoge.com/api/index.php?cid=5'</span>, $cookie, <span class="keyword">false</span>),<span class="keyword">true</span>);</span><br><span class="line">    $bing_img_pid = $bing_img[<span class="string">'data'</span>][<span class="string">'pics'</span>][<span class="string">'pic_1'</span>][<span class="string">'pid'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"$bing_img_pid\n"</span>;</span><br><span class="line"></span><br><span class="line">    $tangshi = jinrishici();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"$tangshi\n"</span>;</span><br><span class="line"></span><br><span class="line">    $post=[</span><br><span class="line">    <span class="string">'title'</span> =&gt;<span class="string">'今日要说什么？'</span>,</span><br><span class="line">    <span class="string">'location'</span> =&gt; <span class="string">'v6_content_home'</span>,</span><br><span class="line">    <span class="string">'text'</span> =&gt; <span class="string">"#诗词[超话]# #中华好诗词# #中国诗词大会#"</span>.<span class="string">"\n"</span>.$tangshi.<span class="string">"\n"</span>.<span class="string">"\n"</span>,<span class="comment">//需要发送微博的内容</span></span><br><span class="line">    <span class="string">'pic_id'</span> =&gt;  <span class="string">"$bing_img_pid"</span>,</span><br><span class="line">    <span class="comment">// '007CcEyfly1g042kquhztj31ns0u0tdu',//微博图片id，需事先上传好 </span></span><br><span class="line">    <span class="string">'isReEdit'</span> =&gt; <span class="keyword">false</span>,</span><br><span class="line">    <span class="string">'pub_source'</span> =&gt; <span class="string">'page_2'</span>,</span><br><span class="line">    <span class="string">'topic_id'</span> =&gt; <span class="string">'1022%3A'</span>,</span><br><span class="line">    <span class="string">'pub_type'</span> =&gt; <span class="string">'dialog'</span>,</span><br><span class="line">    <span class="string">'_t'</span> =&gt; <span class="number">0</span>,</span><br><span class="line">    <span class="string">'style_type'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">    ];</span><br><span class="line">    $url=<span class="string">'https://weibo.com/aj/mblog/add?ajwvr=6&amp;__rnd=2918942797035'</span>;<span class="comment">//不需要改变</span></span><br><span class="line">    $referer=<span class="string">'https://weibo.com/liufengshishe/home?topnav=1&amp;wvr=6'</span>;<span class="comment">//你的微博用户名(首页链接)</span></span><br><span class="line"></span><br><span class="line">    $response = curl($url,$post,<span class="string">''</span>,$cookie,$referer);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"$response\n发送成功"</span>;</span><br></pre></td></tr></table></figure><p><strong>微博登录模块</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!is_file(<span class="string">'./wbcookie.php'</span>)) &#123;</span><br><span class="line">    CookieSet(<span class="string">'SUB;'</span>,<span class="string">'0'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">include</span> <span class="string">'./wbcookie.php'</span>;</span><br><span class="line">  <span class="keyword">require_once</span> <span class="string">'./weiboAccount.php'</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (time() - $config[<span class="string">'time'</span>] &gt;<span class="number">20</span>*<span class="number">3600</span>||$config[<span class="string">'cookie'</span>]==<span class="string">'SUB;'</span>) &#123;</span><br><span class="line">    $cookie = login($sinauser,$sinapwd);</span><br><span class="line">    <span class="keyword">if</span>($cookie&amp;&amp;$cookie!=<span class="string">'SUB;'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      CookieSet($cookie,$time = time());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">return</span> error(<span class="string">'203'</span>,<span class="string">'获取cookie出现错误，请检查账号状态或者重新获取cookie'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * 新浪微博登录(无加密接口版本)</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span>  string $u 用户名</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span>  string $p 密码</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@return</span> string    返回最有用最精简的cookie</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">login</span><span class="params">($u,$p)</span></span>&#123;</span><br><span class="line">    $loginUrl = <span class="string">'https://login.sina.com.cn/sso/login.php?client=ssologin.js(v1.4.15)&amp;_=1403138799543'</span>;</span><br><span class="line">    $loginData[<span class="string">'entry'</span>] = <span class="string">'sso'</span>;</span><br><span class="line">    $loginData[<span class="string">'gateway'</span>] = <span class="string">'1'</span>;</span><br><span class="line">    $loginData[<span class="string">'from'</span>] = <span class="string">'null'</span>;</span><br><span class="line">    $loginData[<span class="string">'savestate'</span>] = <span class="string">'30'</span>;</span><br><span class="line">    $loginData[<span class="string">'useticket'</span>] = <span class="string">'0'</span>;</span><br><span class="line">    $loginData[<span class="string">'pagerefer'</span>] = <span class="string">''</span>;</span><br><span class="line">    $loginData[<span class="string">'vsnf'</span>] = <span class="string">'1'</span>;</span><br><span class="line">    $loginData[<span class="string">'su'</span>] = base64_encode($u);</span><br><span class="line">    $loginData[<span class="string">'service'</span>] = <span class="string">'sso'</span>;</span><br><span class="line">    $loginData[<span class="string">'sp'</span>] = $p;</span><br><span class="line">    $loginData[<span class="string">'sr'</span>] = <span class="string">'1920*1080'</span>;</span><br><span class="line">    $loginData[<span class="string">'encoding'</span>] = <span class="string">'UTF-8'</span>;</span><br><span class="line">    $loginData[<span class="string">'cdult'</span>] = <span class="string">'3'</span>;</span><br><span class="line">    $loginData[<span class="string">'domain'</span>] = <span class="string">'sina.com.cn'</span>;</span><br><span class="line">    $loginData[<span class="string">'prelt'</span>] = <span class="string">'0'</span>;</span><br><span class="line">    $loginData[<span class="string">'returntype'</span>] = <span class="string">'TEXT'</span>;</span><br><span class="line">    <span class="keyword">return</span> loginPost($loginUrl,$loginData); </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * 发送微博登录请求</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span>  string $url  接口地址</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@param</span>  array  $data 数据</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@return</span> json         算了，还是返回cookie吧//返回登录成功后的用户信息json</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">loginPost</span><span class="params">($url,$data)</span></span>&#123;</span><br><span class="line">    $tmp = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">if</span>(is_array($data))&#123;</span><br><span class="line">      <span class="keyword">foreach</span>($data <span class="keyword">as</span> $key =&gt;$value)&#123;</span><br><span class="line">        $tmp .= $key.<span class="string">"="</span>.$value.<span class="string">"&amp;"</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      $post = trim($tmp,<span class="string">"&amp;"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      $post = $data;</span><br><span class="line">    &#125;</span><br><span class="line">    $ch = curl_init();</span><br><span class="line">    curl_setopt($ch,CURLOPT_URL,$url); </span><br><span class="line">    curl_setopt($ch,CURLOPT_RETURNTRANSFER,<span class="number">1</span>); </span><br><span class="line">    curl_setopt($ch,CURLOPT_HEADER,<span class="number">1</span>);</span><br><span class="line">    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">false</span>);</span><br><span class="line">    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="keyword">false</span>);</span><br><span class="line">    curl_setopt($ch,CURLOPT_POST,<span class="number">1</span>);</span><br><span class="line">    curl_setopt($ch,CURLOPT_POSTFIELDS,$post);</span><br><span class="line">    $return = curl_exec($ch);</span><br><span class="line">    curl_close($ch);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'SUB'</span> . getSubstr($return,<span class="string">"Set-Cookie: SUB"</span>,<span class="string">'; '</span>) . <span class="string">';'</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 取本文中间</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getSubstr</span><span class="params">($str,$leftStr,$rightStr)</span></span>&#123;</span><br><span class="line">    $left = strpos($str, $leftStr);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'左边:'</span>.$left;</span><br><span class="line">    $right = strpos($str, $rightStr,$left);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;br&gt;右边:'</span>.$right;</span><br><span class="line">    <span class="keyword">if</span>($left &lt;= <span class="number">0</span> <span class="keyword">or</span> $right &lt; $left) <span class="keyword">return</span> <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">return</span> substr($str, $left + strlen($leftStr), $right-$left-strlen($leftStr));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">    设置cookie文件</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">CookieSet</span><span class="params">($cookie,$time)</span></span>&#123;</span><br><span class="line">    $newConfig = <span class="string">'&lt;?php </span></span><br><span class="line"><span class="string">    $config = array(</span></span><br><span class="line"><span class="string">      "cookie" =&gt; "'</span>.$cookie.<span class="string">'",</span></span><br><span class="line"><span class="string">      "time" =&gt; "'</span>.$time.<span class="string">'",</span></span><br><span class="line"><span class="string">    );'</span>;</span><br><span class="line">    @file_put_contents(<span class="string">'./wbcookie.php'</span>, $newConfig);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">    错误反馈</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">error</span><span class="params">($code,$msg)</span></span>&#123;</span><br><span class="line">    $arr = <span class="keyword">array</span>(<span class="string">'code'</span>=&gt;$code,<span class="string">'msg'</span>=&gt;$msg);</span><br><span class="line">    <span class="keyword">echo</span> json_encode($arr);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><strong>微博账号模块</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$sinauser = <span class="string">'example@email.com'</span>;<span class="comment">//你的微博账号</span></span><br><span class="line">$sinapwd = <span class="string">'123456789'</span>;<span class="comment">//你的微博密码</span></span><br></pre></td></tr></table></figure><h2 id="关于如何使用"><a href="#关于如何使用" class="headerlink" title="关于如何使用"></a>关于如何使用</h2><p>​    本地搭建了lamp环境的话，开启lamp环境后，直接在浏览器地址栏输入localhost及主入口文件对应的路径就可以运行了（本人使用xampp）。</p><p>​    云服务器的话，本人的方案是使用宝塔服务器面板安装lamp环境后，使用xftp将文件传到apache服务器网站根目录上，开启lamp环境就可以了的。</p><h2 id="关于安全性问题"><a href="#关于安全性问题" class="headerlink" title="关于安全性问题"></a>关于安全性问题</h2><p>​    实不相瞒，如果是在云服务器上直接跑这些php文件的话，是不太安全的。因为网站的公共用户具有可以访问微博账号文件的权限。所以，推荐对微博账号文件进行.htaccess设置，也推荐申请个小号来搭建。</p><p>​    具体操作有点复杂，可以参考这篇文章——<a href="https://www.cnblogs.com/engeng/articles/5948089.html" target="_blank" rel="noopener">《apache .htaccess文件详解和配置技巧总结》</a></p><h2 id="关于定时任务"><a href="#关于定时任务" class="headerlink" title="关于定时任务"></a>关于定时任务</h2><p>​    设置定时任务的话可以使用linux主机的crontab命令。</p><ol><li>远程连接主机，连接成功后，输入命令crontab -e；<img src="https://ws1.sinaimg.cn/large/006vCcQDgy1g13zvzzfqhj307200igld.jpg" alt=""></li><li>会打开一个文件，按照格式输入需要执行的脚本；<img src="https://ws1.sinaimg.cn/large/006vCcQDgy1g13zv01ugzj30a801aa9v.jpg" alt=""></li><li>保存退出后，重启crontab服务。<img src="https://ws1.sinaimg.cn/large/006vCcQDgy1g13zwlg4urj30bo0120sn.jpg" alt=""></li></ol><p><strong>语法解释：</strong></p><p><img src="https://i.loli.net/2019/03/15/5c8bafa6379fe.png" alt=""></p><p>“*” 代表取值范围内的数字,<br>“/” 代表”每”,<br>“-” 代表从某个数字到某个数字,<br>“,” 分开几个离散的数字</p><h4 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h4><blockquote><p><a href="https://www.guokr.com/article/81621/" target="_blank" rel="noopener">《揭开“饮水机娘”的神秘面纱》</a></p><p><a href="https://www.cnblogs.com/chasewade/p/3408086.html" target="_blank" rel="noopener">《新浪微博自动（模拟）登陆详解及实现》</a></p><p><a href="https://www.jinrishici.com/doc/" target="_blank" rel="noopener">《今日诗词开放接口-调用文档》</a></p><p><a href="https://cloud.tencent.com/developer/article/1147512" target="_blank" rel="noopener">《利用微博当图床-php语言实现》</a></p><p><a href="https://www.cnblogs.com/engeng/articles/5948089.html" target="_blank" rel="noopener">《apache .htaccess文件详解和配置技巧总结》</a></p><p><a href="https://blog.csdn.net/myuantao3286286/article/details/55095282" target="_blank" rel="noopener">《linux下crontab定时访问指定url》</a></p></blockquote><hr><h4 id="特别致谢"><a href="#特别致谢" class="headerlink" title="特别致谢"></a>特别致谢</h4><blockquote><p><a href="https://www.yuluoge.com/" target="_blank" rel="noopener">九凌少子</a></p></blockquote><hr><p><img src="https://ws1.sinaimg.cn/large/006vCcQDgy1g13zkrqbgaj30i70hxtd5.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;​    在2011年的时候，浙大的一位博士生借助微博的开放平台为他实验室的一台饮水机弄了个微博，名唤@浙大CCNT实验室饮水机，俗称“饮水机娘“。当年自己对这条新闻留下了挺深的印象，也一直对这个微博账号可以自动发微博背后的机理感到十分憧憬。一晃，时间都来到了2019年了~~&lt;/p&gt;
&lt;p&gt;​    咳咳——在钻研不少技术文章以及对技术派网友的多多请教后，自己终于也捣弄了一个自动发微博的机器人(￣︶￣)↗&lt;/p&gt;
    
    </summary>
    
    
      <category term="微博" scheme="http://lesliewong.cn/categories/%E5%BE%AE%E5%8D%9A/"/>
    
      <category term="PHP" scheme="http://lesliewong.cn/categories/%E5%BE%AE%E5%8D%9A/PHP/"/>
    
    
      <category term="微博" scheme="http://lesliewong.cn/tags/%E5%BE%AE%E5%8D%9A/"/>
    
      <category term="PHP" scheme="http://lesliewong.cn/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>给自己的博客网站加上酷炫的初音未来音乐游戏？</title>
    <link href="http://lesliewong.cn/2019/01/12/equiped-an-awesome-music-game-for-my-own-blog-website/"/>
    <id>http://lesliewong.cn/2019/01/12/equiped-an-awesome-music-game-for-my-own-blog-website/</id>
    <published>2019-01-12T12:45:30.000Z</published>
    <updated>2019-02-24T11:45:19.848Z</updated>
    
    <content type="html"><![CDATA[<hr><p>先前在某个Q群里有位网友发了个链接，一点进去，发现是个极度让人耳目一新的初音未来音乐网页游戏。 为了让有幸看到这篇文章的看官也来体会下本人第一次玩时的激动，抛个链接——<a href="https://blog.eunji.cn/music/music.html" target="_blank" rel="noopener">乐柔嘴巴</a>。链接的具体地址是<a href="https://blog.eunji.cn/music/music.html" target="_blank" rel="noopener">blog.eunji.cn/music/music.html</a>。尽管这个页面实在让人上瘾，但是自己同样是个喜欢折腾博客网站的家伙，而这位仁兄是在一个博客网站下放的这个网页。自己就开始思量，可不可以在自己的的博客下<a href="https://www.lesliewong.cn" target="_blank" rel="noopener">www.lesliewong.cn</a>也放个这样的游戏呢？这也很彰显自己的品格&lt;(￣︶￣)&gt;</p><a id="more"></a><p>​    于是自己也就开始开展A计划了。。。</p><hr><h1 id="A计划：无耻地直接盗链"><a href="#A计划：无耻地直接盗链" class="headerlink" title="A计划：无耻地直接盗链"></a>A计划：无耻地直接盗链</h1><p>​    鉴于<a href="https://blog.eunji.cn/music/music.html" target="_blank" rel="noopener">乐柔嘴巴</a>的链接就是一个静态地址，盗链真的是直接就手到擒来、屡试不爽的了。</p><p>​    将自己的博客主页上的“相册”字段对应的链接改成<a href="https://blog.eunji.cn/music/music.html。" target="_blank" rel="noopener">https://blog.eunji.cn/music/music.html。</a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://blog.eunji.cn/music/music.html"</span>&gt;</span>相册<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>效果如下：</p><p><img src="https://i.loli.net/2019/01/12/5c394f23de1d5.png" alt="1547223928655.png" title="1547223928655.png"></p><p>​    看！访问我的网站就可以玩到如此新颖的游戏——<a href="http://www.lesliewong.cn" target="_blank" rel="noopener">www.lesliewong.cn</a></p><p>​    不过，过了不久，还是觉得有些不爽。自己还是有点控制欲的念头的，为什么自己的博客网站要跳转到人家的博客上去玩初音未来的音乐游戏，自己家里就不能玩吗？说白了——看见这个音乐游戏上头的地址栏的域名不是自己的就真心让人不爽。</p><p>​    不行！我要做到点我博客主页链接的时候仍然跳转到我的域名下——</p><p>​    于是，灵机一动下，有了B计划。</p><hr><h1 id="B计划：无耻地反向代理盗链"><a href="#B计划：无耻地反向代理盗链" class="headerlink" title="B计划：无耻地反向代理盗链"></a>B计划：无耻地反向代理盗链</h1><p>​    Nginx服务器具有很强的反向代理功能。通常那些大流量网站都借助Nginx服务器的反向代理功能将访问请求均匀地分配到内网的其他业务服务器进行处理，实现负载均衡功能，业务处理完毕后再通过Nginx服务器返送回去给请求者。</p><p>​    换个方向思考，如果我转发的不是自己内网的业务服务器，而是外网上别人的网站呢？请求者访问我的网站，我将这个请求转发到外网上别人的网站上，然后将他们返回的数据反馈给我的请求者。那么，对于我的请求者而言，他从头到尾都是访问我的网站，而不知道自己收到的数据其实是从另外的网站转发过来的。</p><p>​    在这样的逻辑下，结合这篇文章的指导——<a href="https://www.zifangsky.cn/728.html" target="_blank" rel="noopener">利用Nginx的反向代理克隆生成镜像网站——中间人攻击</a>。自己也就在自己的一台架设了Nginx的服务器上捣弄了。用<u>music.lesliewong.cn</u>这个域名来转发那位仁兄的网页。配置文件如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       <span class="number">80</span>;</span><br><span class="line">    server_name  music.lesliewong.cn;</span><br><span class="line">    root   /webser/www/musiz;</span><br><span class="line">    index  index.php index.html index.htm;</span><br><span class="line">    error_page   <span class="number">500</span> <span class="number">502</span> <span class="number">503</span> <span class="number">504</span>  /<span class="number">50</span>x.html;</span><br><span class="line">    location = /<span class="number">50</span>x.html &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass https:<span class="comment">//blog.eunji.cn/music/music.html;</span></span><br><span class="line">    &#125;   </span><br><span class="line"></span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">        fastcgi_pass   php7-fpm:<span class="number">9000</span>;</span><br><span class="line">        fastcgi_index  index.php;</span><br><span class="line">        <span class="keyword">include</span>        fastcgi_params;</span><br><span class="line">        fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后重启自己的服务器，心想这下该大功告成了吧! 去地址栏里满心欢喜地输入<u>music.lesliewong.cn</u>。然而结果却是——</p><p><img src="https://i.loli.net/2019/01/12/5c395000513d2.png" alt="1547259824230.png" title="1547259824230.png"></p><p>​    吖！自己顿时有点摸不着脑袋，然后回去看那篇<a href="https://www.zifangsky.cn/728.html" target="_blank" rel="noopener">利用Nginx的反向代理克隆生成镜像网站——中间人攻击</a>，最后面作者提示道，“网站全站HTTPS之后，如果网站被克隆了，里面的域名被替换，那么将会因为域名与预期不符从而导致网站显示异常”，也就像上面的炮灰例子一样。自己代理的是一个https的页面，是搞不了Nginx反向代理中间人攻击的。。。话说这也让自己更理解到——Nginx反向代理用的最多的地方还是内网负载均衡，因为内网大都是用http来转发吧？！</p><p>​    自己折腾了这么久，得到的却是这样一个结果，是有几分泄气的。难道就没有办法了吗？难不成自己要一砖一瓦地仿照着写个这样的页面，那有多么可怕啊！难道就没有源码吗？自己可以直接拿来用——</p><p>​    接着，C计划开始筹划。。。</p><hr><h1 id="C计划：原作者源码魔改"><a href="#C计划：原作者源码魔改" class="headerlink" title="C计划：原作者源码魔改"></a>C计划：原作者源码魔改</h1><p>​    自己发现在发这个<a href="https://blog.eunji.cn/music/music.html" target="_blank" rel="noopener">乐柔嘴巴</a>的Q群里有位网友还另外发了个同样的实例网站<a href="http://miku.iysheng.com/。界面如下：" target="_blank" rel="noopener">http://miku.iysheng.com/。界面如下：</a></p><p><img src="https://i.loli.net/2019/01/12/5c3950944c262.png" alt="1547234325453.png" title="1547234325453.png"></p><p>​    现在总算找到了原作者了，原来是彩虹猫歌曲的<a href="https://aidn.jp/" target="_blank" rel="noopener">作者</a>写的，浏览了下他的网站，发现他还弄了好多很有趣的<a href="https://aidn.jp/contents/" target="_blank" rel="noopener">东西</a>——（内心忽然鄙视自己这种可恶的伸手党）</p><p><img src="https://i.loli.net/2019/01/12/5c3950cd63d22.png" alt="1547234782434.png" title="1547234782434.png"></p><p>​    </p><p>​    另外，自己也把失败折腾过程和Q友<a href="https://hexo.itsukio.com/" target="_blank" rel="noopener">执着的少年</a>谈了谈，汗颜的是，没过不久他就把github上的开源镜像给我找到了（好吧，自己当时没想到去github搜一搜）链接如下：</p><p><a href="https://github.com/HFIProgramming/mikutap" target="_blank" rel="noopener">https://github.com/HFIProgramming/mikutap</a></p><p><img src="https://i.loli.net/2019/01/12/5c3950faed03c.png" alt="1547235242065.png" title="1547235242065.png"></p><p>​    自己真的是喜出望外，立马把上面的代码都给fork了下来。然而，使用这些源码发现，出来的效果是这样地。。。</p><p><img src="https://i.loli.net/2019/01/12/5c3950944c262.png" alt="1547234325453.png" title="1547234325453.png"></p><p>​    </p><p>​    而不是我想要的上面乐柔嘴巴的样子——</p><p><img src="https://i.loli.net/2019/01/12/5c39512882022.png" alt="1547235494268.png" title="1547235494268.png"></p><p>​    </p><p>​    不过，既然自己都有了源码，照着人家乐柔嘴巴的样子依葫芦画瓢也就不是什么难事了。自己把源码研究了下，偷梁换柱一番终于实现了自己希冀的效果，配置前后对比如下：</p><hr><h4 id="github源码的index文件："><a href="#github源码的index文件：" class="headerlink" title="github源码的index文件："></a>github源码的index文件：</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"apple-mobile-web-app-capable"</span> <span class="attr">content</span>=<span class="string">"yes"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0, user-scalable=0"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"description"</span> <span class="attr">content</span>=<span class="string">"初音未来版本的通过点击/触摸播放声音并出现变化图案的互动内容。"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Mikutap<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"apple-touch-icon"</span> <span class="attr">href</span>=<span class="string">"icon.png"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"https://fonts.loli.net/css?family=Quicksand:400"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> <span class="attr">href</span>=<span class="string">"shared/sp/css/common.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> <span class="attr">href</span>=<span class="string">"css/mikutap.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.loli.net/ajax/libs/jquery/2.2.4/jquery.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.loli.net/ajax/libs/pixi.js/3.0.11/pixi.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.loli.net/ajax/libs/gsap/1.19.1/TweenMax.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> <span class="attr">src</span>=<span class="string">"shared/js/common-2.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> <span class="attr">src</span>=<span class="string">"js/mikutap.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"view"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"scene_top"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Mikutap<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"ng"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"atten"</span>&gt;</span>十分抱歉<span class="tag">&lt;<span class="name">br</span>&gt;</span>您的浏览器并不支持本页面需要的特性<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ok"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"bt_start"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>!开始!<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"bt_about"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>*关于*<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ok"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"attention"</span>&gt;</span>※请打开声音并享受。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ok"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"tit"</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>注意！搬运内容，原页面(Origin Site): <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://aidn.jp/mikutap"</span>&gt;</span>https://aidn.jp/mikutap<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"scene_loading"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span> <span class="attr">size</span>=<span class="string">"1"</span> <span class="attr">color</span>=<span class="string">"#fff"</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"scene_main"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"set"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"attention"</span>&gt;</span>点击 &amp;amp; 拖动或者按任意键!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"bt_backtrack"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>背景音乐: 开启<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"about_cover"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"about"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"about_in"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"close"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"bt_close"</span>&gt;</span>×<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"con"</span>&gt;</span> 声音来源 <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://ec.crypton.co.jp/pages/prod/vocaloid/mikuv4x"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>Hatsune Miku<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"con"</span>&gt;</span> 作者 <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://aidn.jp"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>daniwell<span class="tag">&lt;/<span class="name">a</span>&gt;</span> (<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://twitter.com/daniwell_aidn"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>twitter<span class="tag">&lt;/<span class="name">a</span>&gt;</span>) <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"link"</span>&gt;</span> 灵感来源 <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://patatap.com/"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>Patatap<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span>(令人赞叹的网页!)<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"bt_back"</span>&gt;</span>＜返回<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"bt_fs"</span>&gt;</span>□全屏显示<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h4 id="自己魔改后的music-html文件："><a href="#自己魔改后的music-html文件：" class="headerlink" title="自己魔改后的music.html文件："></a>自己魔改后的music.html文件：</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- music.html --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"apple-mobile-web-app-capable"</span> <span class="attr">content</span>=<span class="string">"yes"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0, user-scalable=0"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"description"</span> <span class="attr">content</span>=<span class="string">"初音未来版本的通过点击/触摸播放声音并出现变化图案的互动内容。"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>MUSIC - 马树菌的博客驿站<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"apple-touch-icon"</span> <span class="attr">href</span>=<span class="string">"icon.png"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"https://fonts.loli.net/css?family=Quicksand:400"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> <span class="attr">href</span>=<span class="string">"shared/sp/css/common.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> <span class="attr">href</span>=<span class="string">"css/mikutap.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.loli.net/ajax/libs/jquery/2.2.4/jquery.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.loli.net/ajax/libs/pixi.js/3.0.11/pixi.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.loli.net/ajax/libs/gsap/1.19.1/TweenMax.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> <span class="attr">src</span>=<span class="string">"shared/js/common-2.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> <span class="attr">src</span>=<span class="string">"js/mikutap.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"view"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"scene_top"</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>MUSIC<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"ng"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"atten"</span> <span class="attr">style</span>=<span class="string">"font-weight: bold;"</span>&gt;</span>十分抱歉<span class="tag">&lt;<span class="name">br</span>&gt;</span>您的浏览器并不支持本页面面需要的特性<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ok"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"bt_start"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> <span class="attr">style</span>=<span class="string">"font-weight: bold;"</span>&gt;</span>!开始!<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">    <span class="comment">&lt;!-- &lt;p id="bt_about"&gt;&lt;a href=""&gt;*关于*&lt;/a&gt;&lt;/p&gt; --&gt;</span></span><br><span class="line">      </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ok"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"padding-top: 10px;font-weight: bold;"</span>&gt;</span>乐柔要唱歌啦<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"attention"</span> <span class="attr">style</span>=<span class="string">"font-weight: bold;"</span>&gt;</span>※请打开声音并享受。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">  <span class="comment">&lt;!--    &lt;div class="ok"&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">     &lt;p class="tit"&gt;&lt;strong&gt;注意！搬运内容，原页面(Origin Site): &lt;a href="https://aidn.jp/mikutap"&gt;https://aidn.jp/mikutap&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    &lt;/div&gt; --&gt;</span></span><br><span class="line">      </span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"scene_loading"</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span> <span class="attr">size</span>=<span class="string">"1"</span> <span class="attr">color</span>=<span class="string">"#fff"</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"scene_main"</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"set"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"attention"</span> <span class="attr">style</span>=<span class="string">"font-weight: bold;"</span>&gt;</span>点击 &amp;amp; 拖动或者按任意键!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"bt_backtrack"</span> <span class="attr">style</span>=<span class="string">"font-weight: bold;"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>乐柔的嘴巴: 开启<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="comment">&lt;!-- &lt;div id="about_cover"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  &lt;div id="about"&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    &lt;div id="about_in"&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      &lt;p class="close"&gt;&lt;span id="bt_close"&gt;×&lt;/span&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      &lt;p class="con"&gt; 声音来源 &lt;a href="https://ec.crypton.co.jp/pages/prod/vocaloid/mikuv4x" target="_blank"&gt;Hatsune Miku&lt;/a&gt; &lt;/p&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      &lt;p class="con"&gt; 作者 &lt;a href="https://aidn.jp" target="_blank"&gt;daniwell&lt;/a&gt; (&lt;a href="https://twitter.com/daniwell_aidn" target="_blank"&gt;twitter&lt;/a&gt;) &lt;/p&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      &lt;p class="link"&gt; 灵感来源 &lt;a href="http://patatap.com/" target="_blank"&gt;Patatap&lt;/a&gt;&lt;br&gt;(令人赞叹的网页!)&lt;/p&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    &lt;/div&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  &lt;/div&gt; --&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"bt_back"</span> <span class="attr">style</span>=<span class="string">"font-weight: bold;"</span>&gt;</span>＜返回<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"bt_fs"</span> <span class="attr">style</span>=<span class="string">"font-weight: bold;"</span>&gt;</span>☒全屏显示<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>​    具体说来后者的区别就是注释掉了不少内容，换了下一些用词——但，奏效就行(<em>￣▽￣</em>)ブ</p><p>​    （另外，相应的JS文件也进行同样偷梁换柱的操作）</p><p>接着就把这一摞子的源码都放在了自己的hexo博客后台一个命名为MUISIC的文件夹里，并把自己博客主页的“相册”字段改为“音乐”字段且映射到MUSIC文件夹里，最终再git到自己在github上的博客代码仓库。</p><p>​    (<em>^__^</em>) 嘻嘻……</p><p>​    大功告成！C计划完美实现——</p><p><img src="https://i.loli.net/2019/01/12/5c39516768d74.png" alt="1547258339921.png" title="1547258339921.png"></p><hr><h4 id="参考文献："><a href="#参考文献：" class="headerlink" title="参考文献："></a>参考文献：</h4><blockquote><p><a href="https://blog.eunji.cn/music/music.html" target="_blank" rel="noopener">乐柔嘴巴</a></p><p><a href="https://cloud.tencent.com/developer/article/1333764" target="_blank" rel="noopener">Nginx 反向代理学习及实例笔记</a></p><p><a href="https://www.zifangsky.cn/728.html" target="_blank" rel="noopener">利用Nginx的反向代理克隆生成镜像网站——中间人攻击</a></p><p><a href="https://aidn.jp/mikutap/" target="_blank" rel="noopener">原作者daniwell的mikutap原始游戏页面</a></p><p><a href="https://github.com/HFIProgramming/mikutap" target="_blank" rel="noopener">github上国人搬运的mikutap开源镜像</a></p></blockquote><h4 id="特别致谢："><a href="#特别致谢：" class="headerlink" title="特别致谢："></a>特别致谢：</h4><blockquote><p><a href="https://hexo.itsukio.com/" target="_blank" rel="noopener">执着的少年</a></p></blockquote><p><img src="https://i.loli.net/2019/01/12/5c395190d0461.jpg" alt="6.deer.jpg" title="6.deer.jpg"></p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;p&gt;先前在某个Q群里有位网友发了个链接，一点进去，发现是个极度让人耳目一新的初音未来音乐网页游戏。 为了让有幸看到这篇文章的看官也来体会下本人第一次玩时的激动，抛个链接——&lt;a href=&quot;https://blog.eunji.cn/music/music.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;乐柔嘴巴&lt;/a&gt;。链接的具体地址是&lt;a href=&quot;https://blog.eunji.cn/music/music.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;blog.eunji.cn/music/music.html&lt;/a&gt;。尽管这个页面实在让人上瘾，但是自己同样是个喜欢折腾博客网站的家伙，而这位仁兄是在一个博客网站下放的这个网页。自己就开始思量，可不可以在自己的的博客下&lt;a href=&quot;https://www.lesliewong.cn&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;www.lesliewong.cn&lt;/a&gt;也放个这样的游戏呢？这也很彰显自己的品格&amp;lt;(￣︶￣)&amp;gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="游戏" scheme="http://lesliewong.cn/categories/%E6%B8%B8%E6%88%8F/"/>
    
    
      <category term="游戏" scheme="http://lesliewong.cn/tags/%E6%B8%B8%E6%88%8F/"/>
    
  </entry>
  
  <entry>
    <title>如何用优雅的格式打印C语言代码？</title>
    <link href="http://lesliewong.cn/2018/12/14/How-to-print-c-document-in-elegant-format/"/>
    <id>http://lesliewong.cn/2018/12/14/How-to-print-c-document-in-elegant-format/</id>
    <published>2018-12-13T17:53:37.000Z</published>
    <updated>2019-01-13T01:58:32.209Z</updated>
    
    <content type="html"><![CDATA[<p>​自己在学习过程中发现，大家经常用来敲代码的sublime没有提供代码打印功能，而教学过程中用到的Dev-C++打印出来的东西则是歪歪扭扭的，十分难看。Visual C++ 6.0 更是由于兼容性问题，在本人的win10上无法打印——<br>因此，安利一款可以用优雅格式打印C语言代码的软件——Keil C。只需要区区4个步骤，便可用优雅的格式打印C语言代码。</p><a id="more"></a><h3 id="1-下载安装单片机调试软件Keil-C。"><a href="#1-下载安装单片机调试软件Keil-C。" class="headerlink" title="1. 下载安装单片机调试软件Keil C。"></a>1. 下载安装单片机调试软件Keil C。</h3><p><img src="https://i.loli.net/2019/01/11/5c38b116804b2.jpg" alt="打印.jpg" title="打印.jpg"></p><h3 id="2-Keil-C界面工具栏打开C语言文件。"><a href="#2-Keil-C界面工具栏打开C语言文件。" class="headerlink" title="2. Keil C界面工具栏打开C语言文件。"></a>2. Keil C界面工具栏打开C语言文件。</h3><p><img src="https://i.loli.net/2019/01/11/5c38b1a45da95.jpg" alt="格式工厂打印2.jpg" title="格式工厂打印2.jpg"></p><h3 id="3-按Ctrl-P快捷键快速打开打印界面。"><a href="#3-按Ctrl-P快捷键快速打开打印界面。" class="headerlink" title="3. 按Ctrl+P快捷键快速打开打印界面。"></a>3. 按Ctrl+P快捷键快速打开打印界面。</h3><p><img src="https://i.loli.net/2019/01/11/5c38b1ce00441.jpg" alt="打印3.jpg" title="打印3.jpg"></p><h3 id="4-打印完成的页面效果如下，实在很优雅-……"><a href="#4-打印完成的页面效果如下，实在很优雅-……" class="headerlink" title="4. 打印完成的页面效果如下，实在很优雅(^__^) ……"></a>4. 打印完成的页面效果如下，实在很优雅(<em>^__^</em>) ……</h3><p><img src="https://i.loli.net/2019/01/11/5c38b21ddd9f2.jpg" alt="格式工厂打印4.jpg" title="格式工厂打印4.jpg"></p><p><img src="https://i.loli.net/2019/01/11/5c38b23d49eb7.jpg" alt="5.horse.jpg" title="5.horse.jpg"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;​自己在学习过程中发现，大家经常用来敲代码的sublime没有提供代码打印功能，而教学过程中用到的Dev-C++打印出来的东西则是歪歪扭扭的，十分难看。Visual C++ 6.0 更是由于兼容性问题，在本人的win10上无法打印——&lt;br&gt;因此，安利一款可以用优雅格式打印C语言代码的软件——Keil C。只需要区区4个步骤，便可用优雅的格式打印C语言代码。&lt;/p&gt;
    
    </summary>
    
    
      <category term="技巧" scheme="http://lesliewong.cn/categories/%E6%8A%80%E5%B7%A7/"/>
    
    
      <category term="技巧" scheme="http://lesliewong.cn/tags/%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title>借助Docker和Kodexplorer实现简易化部署Discuz类论坛网站</title>
    <link href="http://lesliewong.cn/2018/11/28/How-to-build-a-discuz-forum-using-Docker-and-Kodexplorer/"/>
    <id>http://lesliewong.cn/2018/11/28/How-to-build-a-discuz-forum-using-Docker-and-Kodexplorer/</id>
    <published>2018-11-27T17:53:37.000Z</published>
    <updated>2019-01-13T01:58:08.363Z</updated>
    
    <content type="html"><![CDATA[<p>基于DiscuzX系列构建的论坛可以说是大家在日常浏览各类BBS网站中接触最多的论坛类型了。本教程旨在引导读者通过简单明确的一些步骤就打造出自己的论坛网站，做一个实实在在的站长。</p><a id="more"></a><h2 id="工具-原料"><a href="#工具-原料" class="headerlink" title="工具/原料"></a>工具/原料</h2><blockquote><p>腾讯云服务器 CentOS 7.2 64位；</p><p>远程控制程序  Xshell 6;</p><p>谷歌浏览器 版本号 69.0.3497.81 ；</p><p>DiscuzX3.4代码包。</p></blockquote><h2 id="知识科普"><a href="#知识科普" class="headerlink" title="知识科普"></a>知识科普</h2><blockquote><p><strong>Docker:</strong>Docker是一个开源的引擎，可以轻松地为任何应用创建一个轻量级的、可移植的、自给自足的容器。开发者在笔记本上编译测试通过的容器可以批量地在生产环境中部署，包括VMs（虚拟机）、bare metal、OpenStack集群和其他的基础应用平台。</p><p>Docker通常用于如下场景：</p><ul><li>Web应用的自动化打包和发布；</li><li>自动化测试和持续集成、发布；</li><li>在服务型环境中部署和调整数据库或其他的后台应用；</li><li>从头编译或者扩展现有的OpenShift或Cloud Foundry平台来搭建自己的PaaS环境。</li></ul><p>Docker中文社区：<a href="http://www.docker.org.cn/" target="_blank" rel="noopener">www.docker.org.cn/</a></p><p>Docker官方文档：<a href="https://docs.docker.com/" target="_blank" rel="noopener">https://docs.docker.com/</a></p><p>不过，我们这里所用到的Kodexplorer脚本已经由某位前辈使用Docker容器封装好了。在具体使用时只需要在调用一条命令即可（见下文）</p></blockquote><hr><blockquote><p><strong>Xshell</strong>:一款强大的安全终端模拟软件，支持SHH1，SHH2，以及Microsoft Windows 平台的TELNET协议。Xshell独具创新性的设计和特色，助力于用户在复杂的网络环境中通过互联网安全连接到远程书机中。Xshell有商业版和免费版两种，免费版限于家庭和学校用户，限制也不是太多。</p><p>Xshell官方页面：<a href="https://www.netsarang.com/products/xsh_overview.html" target="_blank" rel="noopener">https://www.netsarang.com/products/xsh_overview.html</a></p></blockquote><hr><blockquote><p><strong>Kodexplorer</strong>:一款快捷高效的私有云和在线文档管理系统，为个人网站、企业私有云部署、网络存储、在线文档管理、在线办公等提供安全可控、简便易用的体验。Kodexplorer采用windows风格界面及操作习惯，用户无需适应即可快速上手，且其支持几百种常用文件格式的在线预览。官方有提供开源版本。</p><p>Kodexplorer官方网站：<a href="https://www.kodcloud.com/" target="_blank" rel="noopener">https://www.kodcloud.com/</a></p></blockquote><hr><blockquote><p>Discuz ! X: Discuz!X 社区软件，是一个采用 PHP 和 MySQL 等其他多种数据库构建的性能优异、功能全面、安全稳定的社区论坛平台，是全球市场占有率第一的社区论坛（BBS）软件。</p><p>Discuz ! 官方站：<a href="http://www.discuz.net/forum-10-1.html" target="_blank" rel="noopener">http://www.discuz.net/forum-10-1.html</a> </p></blockquote><h2 id="详细步骤："><a href="#详细步骤：" class="headerlink" title="详细步骤："></a>详细步骤：</h2><h3 id="1）配置腾讯云服务器"><a href="#1）配置腾讯云服务器" class="headerlink" title="1）配置腾讯云服务器"></a>1）配置腾讯云服务器</h3><blockquote><ol><li><p>购置域名和云服务器</p><p>​    </p><p>用自己的微信号登入腾讯云官网（<a href="https://cloud.tencent.com/），选择左上角云产品中的云服务器，新建云服务器（如图）；" target="_blank" rel="noopener">https://cloud.tencent.com/），选择左上角云产品中的云服务器，新建云服务器（如图）；</a></p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a789a43a5.png" alt="1539352833349.png" title="1539352833349.png"></p><hr><p>进去后就是云服务器的配置界面了，地域、机型的话按自己需要选择，关键在于选择操作系统为<strong>CentOS  7.2 64位</strong>。</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a7bf147e5.png" alt="1539353052321.png" title="1539353052321.png"></p><hr><p>订单完成后就是下图中的状态了。主机密码的话腾讯云会通过站内信的方式发给我们，请注意网站右上角消息，并记得及时修改初始密码）</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a7e28af42.png" alt="1539353208721.png" title="1539353208721.png"></p><hr><p>接下来我们讲注册域名。选择左上角中的云产品的域名注册，进入我的域名管理界面如下</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a80442247.png" alt="1539353436760.png" title="1539353436760.png"></p><hr><p>点击注册域名，在查询框里输入选择自己需要的域名及后缀，查询未被他人占用后加入购物车立即购买即可</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a822d9bcf.png" alt="1539353702890.png" title="1539353702890.png"></p><hr><p>例如本人的域名（已备案）</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a840ae9a3.png" alt="1539353761344.png" title="1539353761344.png"></p><hr><p>注意：众所周知的因素，在腾讯云注册的新域名烦请走下备案流程，具体流程请移步参考腾讯云官方的备案文档（人家已经为你省了很多步骤了）</p><p><a href="https://cloud.tencent.com/document/product/243" target="_blank" rel="noopener">https://cloud.tencent.com/document/product/243</a></p></li><li><p>映射域名和云服务器</p><p>​    </p><p>点击云产品中的云解析进入云解析后台，进入右下边“操作”下的“解析”</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a8766e1cc.png" alt="1539356370101.png" title="1539356370101.png"></p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a89eaa7aa.png" alt="1539356521977.png" title="1539356521977.png"></p><hr><p>添加记录，分别用鼠标点击不同的输入框下方会出现相应说明。自己多体验——</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a8d180720.png" alt="1539356695756.png" title="1539356695756.png"></p><hr><p>对于我们目前讲到的这个实例来说，我们选择记录类型为A，在记录值中输入自己云服务器的公网IP（在云服务器控制台可查）</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a90065f39.png" alt="1539357062935.png" title="1539357062935.png"></p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a91a9dec1.png" alt="1539357011006.png" title="1539357011006.png"></p><hr><p>设置好了后，保存即可。</p></li></ol><p>   就这样，云服务器和域名的映射就设置好了——</p></blockquote><hr><h3 id="2）Xshell远程连接服务器"><a href="#2）Xshell远程连接服务器" class="headerlink" title="2）Xshell远程连接服务器"></a>2）Xshell远程连接服务器</h3><blockquote><p>​    登录云服务器的话，可以直接在腾讯云官网的云服务器后台里登录（如图），不过我们这里采用的是另外一种方法，使用专业远程控制软件Xshell来协助远程登录。</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a94693e80.png" alt="1539357779494.png" title="1539357779494.png"></p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a983c27a6.png" alt="1539357880701.png" title="1539357880701.png"></p></blockquote><blockquote><hr><p>1.到官网下载Xshell 6 软件</p><p>在浏览框里输入以下链接：<a href="https://www.netsarang.com/products/xsh_overview.html" target="_blank" rel="noopener">https://www.netsarang.com/products/xsh_overview.html</a> 进入Xshell的官方下载界面</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a9a68c6ad.png" alt="1539440950942.png" title="1539440950942.png"></p><hr><p>点击download后进入版本选择界面，选择家庭/学校用途版本,随便填写一些信息及重要的电子邮件地址，提交就行。</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a9c054eaa.png" alt="1539441010102.png" title="1539441010102.png"></p><hr><p>​    之后便会有邮件发至电子邮箱，点击里面的链接 </p><p>​    即可下载。</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a9e4b1150.png" alt="1539441240936.png" title="1539441240936.png"></p><hr><p>2.安装Xshell 6 </p><p>双击下载完成的exe文件，进行安装</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38aa069ae0b.png" alt="1539442812495.png" title="1539442812495.png"></p><hr><p>安装界面，点下一步，同意条款，下一步，随便输入名字公司信息，安装到C盘外，确定安装，进度条跑完即可 </p><hr><p><img src="https://i.loli.net/2019/01/11/5c38aa25af089.png" alt="1539443197084.png" title="1539443197084.png"></p><hr><p><img src="https://i.loli.net/2019/01/11/5c38aa479064e.png" alt="1539443248146.png" title="1539443248146.png"></p><hr><p><img src="https://i.loli.net/2019/01/11/5c38aa6aeab30.png" alt="1539443286639.png" title="1539443286639.png"></p><hr><p><img src="https://i.loli.net/2019/01/11/5c38aa84c72a2.png" alt="1539443365470.png" title="1539443365470.png"></p><hr><p>3.Xshell连接远程服务器</p><p>运行Xshell, 初始界面如下</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38aaa406125.png" alt="1539615814983.png" title="1539615814983.png"></p><hr><p>点菜单栏文件— 新建，出现新建会话弹窗。在主机输入框中输入自己的云服务器分配的公网IP，其他设置不变，点击“连接”</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38aabf7d795.png" alt="1539616198499.png" title="1539616198499.png"></p><hr><p>之后会出现SSH安全警告，如果是在自己的电脑上操作的话，“接受并保存”即可。</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38ac86ce8b7.jpg" alt="1539616297332.jpg" title="1539616297332.jpg"></p><hr><p>输入登录用户名（默认为root)</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38ab011b479.png" alt="1539616367172.png" title="1539616367172.png"></p><hr><p>接下来输入主机密码</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38ab23dffb2.png" alt="1539616544527.png" title="1539616544527.png"></p><hr><p>登录成功！ &lt;(￣ˇ￣)/）</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38b059823bb.jpg" alt="1539616844526.jpg" title="1539616844526.jpg"></p><hr><p>这样，本地与远程云服务器的连接就完成了！</p><p>(^o^)/~</p></blockquote><hr><h3 id="3）借助Docker向服务器安装脚本"><a href="#3）借助Docker向服务器安装脚本" class="headerlink" title="3）借助Docker向服务器安装脚本"></a>3）借助Docker向服务器安装脚本</h3><blockquote><p>1.连接成功后，在命令行界面输入以下脚本命令</p><p>curl -sSL <a href="http://www.xinghuankj.com/docker/script/xinghuan-V1.6.sh" target="_blank" rel="noopener">http://www.xinghuankj.com/docker/script/xinghuan-V1.6.sh</a> | bash</p><p>按回车就可以开始安装用Docker封装好的Kodexplorer脚本了.</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38acc3ca254.png" alt="1539627239350.png" title="1539627239350.png"></p><hr><p>2.当命令行界面出现“请修改需要访问网站的电脑或者主机的hosts文件，将以下内容加入hosts文件”提示的时候，即宣告安装完成了。我们移步到浏览器那里去折腾。</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38ace5a82d2.png" alt="1539627697904.png" title="1539627697904.png"></p><hr></blockquote><hr><h3 id="4）浏览器操作Kodexplorer"><a href="#4）浏览器操作Kodexplorer" class="headerlink" title="4）浏览器操作Kodexplorer"></a>4）浏览器操作Kodexplorer</h3><blockquote><p> 1.浏览器地址栏里输入主机IP（也可输入已配置好的域名），访问Kodexplorer，初始界面如下，需要我们设置管理员账号</p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38ad131d7e4.png" alt="1539627757821.png" title="1539627757821.png"></p><hr><p> 2.设置完毕点登录，会跳转到Kodexplorer登录界面，用我们刚才的管理员账号直接登录</p><p> （PS: 可能会出现Kodexplorer版本更新弹窗，按照指示操作就行）</p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38ad37a1d3d.png" alt="1539627797489.png" title="1539627797489.png"></p><hr><p> 3.登录成功后的界面如下，可以注意到右上边有个提示告诉我们文件仅为只读状态。我们需要移步到Xshell中获取Kodexplorer的文件读写权限。</p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38ad530a864.png" alt="1539627933216.png" title="1539627933216.png"></p><hr><p> 4.在Xshell的命令行界面输入以下命令</p><p> chmod -R 777 /webser/</p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38ad7121732.png" alt="1539628008064.png" title="1539628008064.png"></p><hr><p> 5.回到浏览器中，点刷新，就会发现右上边的提示符号消失了，我们成功地获取了文件读写权限</p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38ad9633344.png" alt="1539629018926.png" title="1539629018926.png"></p><hr><p> 折腾到这儿，一个直接在浏览器跑的的图形化Web网站管理后台就基本有了雏形了。接下来，我们就借助这个平台，上传DiscuzX！压缩包，做建站准备。</p></blockquote><hr><h3 id="5）创建DiscuzX网站资源管理后台"><a href="#5）创建DiscuzX网站资源管理后台" class="headerlink" title="5）创建DiscuzX网站资源管理后台"></a>5）创建DiscuzX网站资源管理后台</h3><blockquote><p> 1.前往DiscuzX！的官方代码托管站点下载代码压缩包。网址是 <a href="https://gitee.com/ComsenzDiscuz/DiscuzX" target="_blank" rel="noopener">https://gitee.com/ComsenzDiscuz/DiscuzX</a> 界面如下：</p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38adbd9f297.png" alt="1542481517619.png" title="1542481517619.png"></p><hr><p> 2.点击上图箭头所指示的“克隆/下载”按钮，下载zip压缩包到本地。（什么验证码之类的就照人家提示做就行了——）</p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38addf3f0b5.png" alt="1542481977323.png" title="1542481977323.png"></p><hr><p> 3.跳转回先前的kodexplorer管理后台，进入到/webser/www/对应的文件夹目录下面，上传DiscuzX压缩包。</p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38adfc42e51.png" alt="1542482296406.png" title="1542482296406.png"></p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38ae135a06e.png" alt="1542482355809.png" title="1542482355809.png"></p><hr><p> 4.操作完成界面如下，接着就双击zip包解压缩，将子文件夹upload右键解压到当前目录。</p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38ae38ee0a8.png" alt="1542482555141.png" title="1542482555141.png"></p><hr><p> 5.将upload重命名为dz。（0.o   看自己想法了）  接下来前往/webser/compose/nginx/conf.d/目录下。</p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38ae528ef09.png" alt="1542483128118.png" title="1542483128118.png"></p><hr><p> 6.右键kod.conf-更多-创建副本，并将副本重命名为dz.conf，然后打开dz.conf, </p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38ae698c08e.png" alt="1542483393558.png" title="1542483393558.png"></p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38ae8ce7963.png" alt="1542483825857.png" title="1542483825857.png"></p><hr><p> 7.改写root字段的内容为 /webser/www/dz,   server_name字段改为example.lesliewong.cn. (读者请填写自己对应服务器映射的域名)</p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38aec710ac6.png" alt="1542484287768.png" title="1542484287768.png"></p><hr><p> 8.同时还要修改同一目录下的kod.conf文件，修改内容如图所标（域名请自觉对应），作用是使这个域名映射到DiscuzX站点的管理后台。（依旧是这个kodexplorer资源管理器）</p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38aeecc8287.png" alt="1542600360615.png" title="1542600360615.png"></p><hr><p> 9.OK，做完这些之后马上就要大功告成了！ 接下来我们转移到 Xshell6命令行界面上，输入下面一行命令重启nginx服务器。 </p><p> docker restart nginx </p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38af18ea729.png" alt="1542599669959.png" title="1542599669959.png"></p><hr><p> 10.转到浏览器网址栏输入刚才的dz文件夹域名example.lesliewong.cn. 铛铛~铛铛！DiscuzX的配置页面出现了！</p><hr><p> <img src="https://i.loli.net/2019/01/11/5c38af39b8808.png" alt="1542600619767.png" title="1542600619767.png"></p><hr></blockquote><hr><h3 id="6）连接数据库对接DiscuzX站点"><a href="#6）连接数据库对接DiscuzX站点" class="headerlink" title="6）连接数据库对接DiscuzX站点"></a>6）连接数据库对接DiscuzX站点</h3><blockquote><p>1.照着页面上的提示按钮，我同意——（开始安装）下一步——（设置运行环境：全新）下一步，就到了         创建数据库页面，如下。在此我们需要打住一下，回到我们的腾讯云主机管理页面。</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38af5f6bc63.png" alt="1542602776485.png" title="1542602776485.png"></p><hr><p>2.来到腾讯云主机管理页面，如下图，复制主机对应的内网IP，然后填写到上面的DiscuzX表单上的数据库服务器字段（去掉localhost）。</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38af8397193.png" alt="1543301253211.png" title="1543301253211.png"></p><hr><p>3.接着我们需要到Kodexplorer界面去获取数据库密码，如下图。打开/webser/README.MD, 弹出的文件里面有写数据库密码，将其复制下来，同样拷贝到上面的DiscuzX表单中。</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38af9c3939b.png" alt="1543303448584.png" title="1543303448584.png"></p><hr><p>4.完成上面的步骤后，再补充表单中其他的信息，就是下面这个样子了。</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38afb4c265e.png" alt="1543307987994.png" title="1543307987994.png"></p><hr><p>5.万事俱备，只欠东风。OK！点击“下一步”。进度条跑完就是下面这个页面了——</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38afd575f2d.png" alt="1543308134838.png" title="1543308134838.png"></p><hr><p>6.点击右下角的“您的论坛已完成安装，点此访问”即可访问我们的目标站点，DiscuzX 论坛原始界面。至于后面的怎样论坛定制化，大家就去DiscuzX的官方论坛看一些优秀的教程吧！有很多开源的应用可以使用。</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38aff2d430a.png" alt="1543308358551.png" title="1543308358551.png"></p><hr><p>​    ~ o(<em>￣▽￣</em>)ブ</p></blockquote><hr><h2 id="尾语"><a href="#尾语" class="headerlink" title="尾语"></a>尾语</h2><blockquote><hr><p>教程到这里，建站流程就走完了，感谢各位耐心看到这里&lt;(￣ˇ￣)/</p><p>通过这个教程，我们接触到了kodexplorer，一款很好用的直接在浏览器跑的图形化资源管理器，xshell 6， Linux机器远程控制软件，以及云的知识~~， 当然也少不了我们关注的主角——DiscuzX论坛。</p><p>相信在未来的发展中，各位依旧可以发现这些工具对自己起到很大的帮助。</p><p>共勉   ~&lt;(￣︶￣)↗</p><hr></blockquote><hr><h6 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h6><blockquote><p><a href="http://api.xinghuankj.com/" target="_blank" rel="noopener">http://api.xinghuankj.com/</a></p><p><a href="https://kodcloud.com/help/show-1.html" target="_blank" rel="noopener">https://kodcloud.com/help/show-1.html</a></p><p><a href="https://www.youtube.com/watch?v=IN7FrJopIIM" target="_blank" rel="noopener">https://www.youtube.com/watch?v=IN7FrJopIIM</a></p><p><a href="http://www.docker.org.cn/book/docker/what-is-docker-16.html" target="_blank" rel="noopener">http://www.docker.org.cn/book/docker/what-is-docker-16.html</a></p></blockquote><p><img src="https://i.loli.net/2019/01/11/5c38b0cc1aa7d.jpg" alt="4.cow.jpg" title="4.cow.jpg"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;基于DiscuzX系列构建的论坛可以说是大家在日常浏览各类BBS网站中接触最多的论坛类型了。本教程旨在引导读者通过简单明确的一些步骤就打造出自己的论坛网站，做一个实实在在的站长。&lt;/p&gt;
    
    </summary>
    
    
      <category term="前端" scheme="http://lesliewong.cn/categories/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="建站" scheme="http://lesliewong.cn/categories/%E5%89%8D%E7%AB%AF/%E5%BB%BA%E7%AB%99/"/>
    
    
      <category term="前端" scheme="http://lesliewong.cn/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="建站" scheme="http://lesliewong.cn/tags/%E5%BB%BA%E7%AB%99/"/>
    
  </entry>
  
  <entry>
    <title>一元多项式的加法、减法、乘法和微分运算的C语言链表结构算法实现</title>
    <link href="http://lesliewong.cn/2018/11/03/A-C-algorithm-with-linked-list-to-express-addition-subtraction-multiplication-differential-of-polynomial/"/>
    <id>http://lesliewong.cn/2018/11/03/A-C-algorithm-with-linked-list-to-express-addition-subtraction-multiplication-differential-of-polynomial/</id>
    <published>2018-11-03T12:45:30.000Z</published>
    <updated>2019-01-13T01:57:39.315Z</updated>
    
    <content type="html"><![CDATA[<p>利用链表实现一元多项式的数学运算。如一元多项式 </p><img src="/2018/11/03/A-C-algorithm-with-linked-list-to-express-addition-subtraction-multiplication-differential-of-polynomial/1543086464267.png" title="This is an example image"><p>可以利用其系数p和指数e组合的方式实现链式存储。通过对线性表的基本操<br>作，例如插入，删除，查找等可以实现一元多项式的复杂运算，比如加，减，<br>乘，除等运算。 </p><a id="more"></a><h4 id="基本要求"><a href="#基本要求" class="headerlink" title="基本要求"></a>基本要求</h4><p>利用链表存储一元多项式，通过对链表的操作实现多项式的运算。 </p><h4 id="测试数据"><a href="#测试数据" class="headerlink" title="测试数据"></a>测试数据</h4><p>对于多项式：A(x) = 7 + 3x + 9x + 5x，B(x) = 8x + 22x − 9x，实现加，减，乘和微分，输出结果。</p><h3 id="解答："><a href="#解答：" class="headerlink" title="解答："></a>解答：</h3><h4 id="实现思路"><a href="#实现思路" class="headerlink" title="实现思路"></a>实现思路</h4><blockquote><p>代码结构为主分形式，主函数主要为一些提示，具体的输入输出则将参数传递到分函数中实现。分函数有创建一元多项式、多项式升幂排序、比较项指数大小、打印多项式、加法运算、减法运算、微分运算和乘法运算等。</p><hr><p>比较需要关注的是乘法方面的实现，思路是将乘法运算分解为一系列的加法运算。不过在这里着实纠结了好多天，本来呢觉得实现乘法自己应该为它再另外构造一个加法算法提供接口，以便实现它的加法迭代。可是呢，这样完全行不通，打印出来的都是0.0，自己完全不晓得为什么，重复对着代码思考了好多次了，觉得没什么毛病，但就是行不通——</p><hr><p>然后呢，大概是前天吧！自己捣弄了半天代码调试依旧不会的情况下，决定回归输出调试，于是就在乘法函数里注释掉了迭代用的加法，另外在加法循环体外面上头加了两句打印语句想看看多项式A和多项式B的每一项相乘后得到的结果是咋样的。</p><hr><p>于是乎奇迹就诞生了，用x^1+2x^2+3x^3和x^1作为测试数据，莫名其妙地乘法结果就给打印出来了，完全没有用到我费了九牛二虎之力写出来的迭代加法——</p><hr><p>不过显示结果还是有点小bug，显示出来的是正确结果的相反数，而且主函数返回值也不是正常的0，而是莫名其妙的3221225477</p><hr><p>接着本着修bug的精神就在乘法函数里运算部分乘了个负一，这下结果就好看了，如下（返回值依旧不正常）</p></blockquote><p><img src="https://i.loli.net/2019/01/11/5c38b4bb12219.png" alt="1541253016150.png" title="1541253016150.png"></p><blockquote><p>但是，天下怎么会有凭空掉馅饼这等好事！？自己再用上面给出的复杂测试数据跑了下，这下就没那么好看了，得出来的是一个明显错误的结果(。﹏。*)</p></blockquote><p><img src="https://i.loli.net/2019/01/11/5c38b4f415e63.png" alt="1541252764755.png" title="1541252764755.png"></p><blockquote><p>而且也发现了微分算法部分的一个小bug——</p><p>好吧，只能后续继续改进了，自己应该是在指针理解上出现了问题，回头去《深入理解C指针》。</p><hr><p>另外，假如用户输入的两个一元多项式为相同的话，输出也会有点不正常，需要弄弄。</p><p>看来有点眉目了</p></blockquote><p><img src="https://i.loli.net/2019/01/11/5c38b539227db.png" alt="abc.png" title="abc.png"></p><blockquote><p>11.25这天晚上，我终于弄明白了bug的缘由——丫蛋自己没把Pd给初始化！，而且打印函数如果给它的参数是个空地址的话，它会在那儿瞎转悠几圈，然后返回个不是0的返回值，直接结束程序——</p><hr><p>（还修复了打印首项有时会出现加号的小bug）</p><p>还存在一个问题，就是如果输入的两个多项式是相同的话，减法那部分结果会不显示任何值，而不是0。得弄弄</p><p>（已解决）</p><hr><p>OK，下面就贴下自己的代码了，折腾带注释版本，以及去掉无关注释~纯净版本^_^</p></blockquote><h4 id="实现代码-折腾注释版-："><a href="#实现代码-折腾注释版-：" class="headerlink" title="实现代码(折腾注释版)："></a>实现代码(折腾注释版)：</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">term</span>&#123;</span></span><br><span class="line"><span class="keyword">float</span> coef;</span><br><span class="line"><span class="keyword">int</span> expn;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">term</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;term,*LinkList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> LinkList polynomial;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(LinkList pa,LinkList pb)</span>                <span class="comment">//比较各项指数大小</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(pa-&gt;expn &gt; pb-&gt;expn)</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(pa-&gt;expn == pb-&gt;expn)</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LocateElem</span><span class="params">(LinkList L,LinkList t,LinkList *q)</span>    <span class="comment">/*定位项数指数大小，使多项式按升幂排序               这里的*q起到内存保护的作用*/</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LinkList p1=L-&gt;next;</span><br><span class="line">LinkList p2=L;</span><br><span class="line"><span class="keyword">while</span>(p1)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(t-&gt;expn &gt; p1-&gt;expn)</span><br><span class="line">&#123;</span><br><span class="line">p1=p1-&gt;next;</span><br><span class="line">p2=p2-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(t-&gt;expn == p1-&gt;expn)</span><br><span class="line">&#123;</span><br><span class="line">*q=p1;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">*q=p2;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*q=p2;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CreatePolyn</span><span class="params">(polynomial P)</span><span class="comment">//建立多项式所需的各项具体值</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LinkList t;</span><br><span class="line">LinkList q;</span><br><span class="line">P-&gt;coef=<span class="number">0.0</span>;</span><br><span class="line">P-&gt;expn=<span class="number">-1</span>;</span><br><span class="line">P-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Please input coefficient and exponent below in format like 1,2 and end with 0,0:\n"</span>);</span><br><span class="line"></span><br><span class="line">t=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">   <span class="comment">// if(!t) exit(OVERFLOW);   //借鉴教材《数据结构（C语言版）》的代码风格...没用</span></span><br><span class="line">t-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%f,%d"</span>,&amp;t-&gt;coef,&amp;t-&gt;expn);</span><br><span class="line"><span class="keyword">while</span>(t-&gt;coef||t-&gt;expn)            <span class="comment">//约定0,0结束输入，实现动态输入多项式</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!LocateElem(P,t,&amp;q))             <span class="comment">/*每次输入的指数都应不同，转移指针P-&gt;q,而且实现指数排序（这里 &amp;q 博大精深， 利用指针的指针之妙法确保指针不被篡改，在LocateElem内部又机智地取回———）*/</span></span><br><span class="line">&#123;</span><br><span class="line">t-&gt;next=q-&gt;next;                <span class="comment">/*1.q-&gt;next = NULL,2.q-&gt;next = t，    也改变了P-&gt;next的值  P与q共享内存*/</span></span><br><span class="line">q-&gt;next=t;                      <span class="comment">//对t, 头插法, 对q, 尾插法</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">        t=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">         <span class="comment">//  if(!t) exit(OVERFLOW);</span></span><br><span class="line">t-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%f,%d"</span>,&amp;t-&gt;coef,&amp;t-&gt;expn);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printPolyn</span><span class="params">(polynomial P)</span><span class="comment">//打印多项式</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LinkList q;</span><br><span class="line">q=P-&gt;next;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(!q)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"0\n"</span>);  <span class="comment">//针对两多项式相同的情况</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">while</span>(q)</span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">if</span>(q-&gt;coef==<span class="number">0</span>)<span class="comment">/*主要针对微分的常数项情况，可是出现了下一项变为首项但其前面加号没有去掉的情况。。。*/</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">""</span>);</span><br><span class="line">            q=q-&gt;next;<span class="comment">/*将此if结构与下面if结构分开，不耦合，解决打印首项带加号问题*/</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span>(q-&gt;expn==<span class="number">0</span>)                         <span class="comment">//判断指数是否为零及正负，调整输出格式</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.2f"</span>,q-&gt;coef);</span><br><span class="line">q=q-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(q-&gt;expn&gt;<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.2f*x^%d"</span>,q-&gt;coef,q-&gt;expn);</span><br><span class="line">q=q-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.2f*x^(%d)"</span>,q-&gt;coef,q-&gt;expn);</span><br><span class="line">q=q-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(q)<span class="comment">//判断下一项系数正负，调整输出格式</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(q-&gt;coef&gt;<span class="number">0</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"+"</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddPolyn</span><span class="params">(polynomial Pa,polynomial Pb,polynomial Pc)</span>    <span class="comment">/*不完全参照教科书上的思路，而是另外开辟空间存储和，不释放原来数据空间*/</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LinkList qa=Pa-&gt;next;</span><br><span class="line">LinkList qb=Pb-&gt;next;</span><br><span class="line">LinkList qc=Pc;</span><br><span class="line">LinkList head=qc;</span><br><span class="line">LinkList s;</span><br><span class="line"><span class="keyword">float</span> sum; </span><br><span class="line"></span><br><span class="line">Pc-&gt;coef=<span class="number">0.0</span>;</span><br><span class="line">Pc-&gt;expn=<span class="number">-1</span>;</span><br><span class="line">Pc-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(qa&amp;&amp;qb)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">switch</span>(cmp(qa,qb))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">-1</span>:</span><br><span class="line">s=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">                   <span class="comment">//if(!s) exit(OVERFLOW);</span></span><br><span class="line">*s=*qa;</span><br><span class="line">qc-&gt;next=s;</span><br><span class="line">qc=s;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">sum=qa-&gt;coef+qb-&gt;coef;</span><br><span class="line"><span class="keyword">if</span>(sum!=<span class="number">0.0</span>)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">s=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">                       <span class="comment">//if(!s) exit(OVERFLOW);</span></span><br><span class="line">*s=*qa;</span><br><span class="line">s-&gt;coef=sum;</span><br><span class="line"></span><br><span class="line">qc-&gt;next=s;</span><br><span class="line">qc=s;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">qc-&gt;next=qa-&gt;next;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">s=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">                <span class="comment">//  if(!s) exit(OVERFLOW);</span></span><br><span class="line">*s=*qb;   </span><br><span class="line">qc-&gt;next=s;</span><br><span class="line">qc=s;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">qc-&gt;next=qa?qa:qb;    <span class="comment">//添加NULL尾巴</span></span><br><span class="line">Pc=head;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SubPolyn</span><span class="params">(polynomial Pa,polynomial Pb,polynomial Pc)</span>   <span class="comment">/*思路同前面加法，减法变加法，前面加负号，  另外开辟空间存储差*/</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LinkList qa=Pa-&gt;next;</span><br><span class="line">LinkList qb=Pb-&gt;next;</span><br><span class="line">LinkList qc=Pc;</span><br><span class="line">LinkList head=qc;</span><br><span class="line">LinkList s;</span><br><span class="line"><span class="keyword">float</span> differ; </span><br><span class="line"></span><br><span class="line">Pc-&gt;coef=<span class="number">0.0</span>;</span><br><span class="line">Pc-&gt;expn=<span class="number">-1</span>;</span><br><span class="line">Pc-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(qb)          <span class="comment">//为减数加负号</span></span><br><span class="line">&#123;</span><br><span class="line">qb-&gt;coef=<span class="number">0</span>-(qb-&gt;coef);</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">qb=Pb-&gt;next;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(qa&amp;&amp;qb)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">switch</span>(cmp(qa,qb))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">-1</span>:</span><br><span class="line">s=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">                <span class="comment">//   if(!s) exit(OVERFLOW);</span></span><br><span class="line">*s=*qa;</span><br><span class="line">qc-&gt;next=s;</span><br><span class="line">qc=s;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">differ=qa-&gt;coef+qb-&gt;coef;</span><br><span class="line"><span class="keyword">if</span>(differ!=<span class="number">0.0</span>)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">s=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">                    <span class="comment">//   if(!s) exit(OVERFLOW);</span></span><br><span class="line">*s=*qa;</span><br><span class="line">s-&gt;coef=differ;</span><br><span class="line">qc-&gt;next=s;</span><br><span class="line">qc=s;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">qc-&gt;next=qa-&gt;next;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">s=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">                 <span class="comment">//  if(!s) exit(OVERFLOW);</span></span><br><span class="line">*s=*qb;</span><br><span class="line">   </span><br><span class="line">qc-&gt;next=s;</span><br><span class="line">qc=s;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">qc-&gt;next=qa?qa:qb;</span><br><span class="line">Pc=head;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddPolyn_multi</span><span class="params">(polynomial Pa,polynomial Pb)</span>    <span class="comment">/*构造一个可以用于乘法项数迭代的特殊加法,释放空间，和储存至Pa，方便迭代累加*/</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LinkList qa=Pa-&gt;next;<span class="comment">//这两句导致项数错位了？</span></span><br><span class="line">LinkList qb=Pb-&gt;next;</span><br><span class="line"><span class="comment">//LinkList qa=Pa;</span></span><br><span class="line">    <span class="comment">//LinkList qb=Pb;</span></span><br><span class="line">    LinkList qc=Pa;</span><br><span class="line">LinkList head=qc;</span><br><span class="line">LinkList s,s1,s2;</span><br><span class="line"><span class="keyword">float</span> sum;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(qa&amp;&amp;qb)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">switch</span>(cmp(qa,qb))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">-1</span>:</span><br><span class="line">qc-&gt;next=qa;</span><br><span class="line">qc=qa;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">sum=qa-&gt;coef+qb-&gt;coef;</span><br><span class="line"><span class="keyword">if</span>(sum!=<span class="number">0.0</span>)</span><br><span class="line">&#123;</span><br><span class="line">s=qb;</span><br><span class="line">qa-&gt;coef=sum;</span><br><span class="line">qc-&gt;next=qa;</span><br><span class="line">qc=qa;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"><span class="built_in">free</span>(s);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">s1=qa;</span><br><span class="line">s2=qb;</span><br><span class="line">qc-&gt;next=qa-&gt;next;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"><span class="built_in">free</span>(s1);</span><br><span class="line"><span class="built_in">free</span>(s2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">qc-&gt;next=qb;</span><br><span class="line">qc=qb;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">qc-&gt;next=qa?qa:qb;</span><br><span class="line">Pa=head;   <span class="comment">//千思万虑老子终于把你给揪出来了，原来是形参搞得鬼！？</span></span><br><span class="line">    <span class="comment">//printPolyn(Pa);</span></span><br><span class="line">    <span class="comment">//pirntf("\n");</span></span><br><span class="line"><span class="comment">//free(Pb);     /*这句语句挺有问题，要是该指数项唯有Pb才有呢，相加后依然链接到Pb的内存空间上 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MultiPolyn</span><span class="params">(polynomial Pa,polynomial Pb,polynomial Pc)</span>       <span class="comment">/*乘法运算，分解为一系列的加法运算*/</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LinkList qa=Pa-&gt;next;</span><br><span class="line">LinkList qb=Pb-&gt;next;</span><br><span class="line"><span class="comment">// LinkList qc=Pc;</span></span><br><span class="line">LinkList head;</span><br><span class="line">LinkList qd;</span><br><span class="line">LinkList t[<span class="number">20</span>],d[<span class="number">20</span>],h[<span class="number">20</span>];<span class="comment">/*,s1,s2;  这些结构体指针数组所对应的空间也应该为它们加个指数值为负一的内存！ 有啊！！！*/</span> </span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"><span class="comment">//float product; </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/******下面添加的这两句由于思考疏忽耗费了我大半个月的精力********/</span></span><br><span class="line">    Pc-&gt;coef=<span class="number">0.0</span>;</span><br><span class="line">    Pc-&gt;expn=<span class="number">-1</span>;</span><br><span class="line">    Pc-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/******以上*********/</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">while</span>(qa&amp;&amp;qb)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">20</span>;j++)</span><br><span class="line">&#123;</span><br><span class="line">d[j]=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">              <span class="comment">// if(!d[j]) exit(OVERFLOW);</span></span><br><span class="line">d[j]-&gt;coef=<span class="number">0.0</span>;</span><br><span class="line">d[j]-&gt;expn=<span class="number">-1</span>; </span><br><span class="line">d[j]-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">h[j]=d[j];</span><br><span class="line">qd=qa;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">20</span>;i++)                      <span class="comment">/*二维数组应该有两个中括号吧？  不，不用，用了指针 */</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//leave it alone!</span></span><br><span class="line"></span><br><span class="line">t[i]=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line"><span class="comment">//   if(!t[i]) exit(OVERFLOW);</span></span><br><span class="line">*t[i]=*qd;</span><br><span class="line">t[i]-&gt;coef=(qd-&gt;coef)*(qb-&gt;coef)*(<span class="number">-1</span>);</span><br><span class="line">t[i]-&gt;expn=qd-&gt;expn+qb-&gt;expn;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">d[j]-&gt;next=t[i];</span><br><span class="line"></span><br><span class="line">d[j]=t[i];</span><br><span class="line">qd=qd-&gt;next;</span><br><span class="line"><span class="keyword">if</span>(!qd)</span><br><span class="line">&#123;</span><br><span class="line">d[j]-&gt;next=<span class="literal">NULL</span>; </span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"><span class="keyword">if</span>(!qb)</span><br><span class="line">&#123;</span><br><span class="line">h[j+<span class="number">1</span>]=<span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//printPolyn(h[0]);</span></span><br><span class="line">    <span class="comment">//printPolyn(h[1]);</span></span><br><span class="line">    <span class="comment">//printPolyn(h[2]);</span></span><br><span class="line">    <span class="comment">//printPolyn(h[3]);</span></span><br><span class="line">    <span class="comment">/*非常奇怪，加了这两句就可以运行乘法了，不过打印出来的却是相反数，而且返回值不是0，而是3221225477 </span></span><br><span class="line"><span class="comment">//现在不用那个特殊加法也可以了！？难道是因为我创建的那伪二维数组实现了地址的复用？？？</span></span><br><span class="line"><span class="comment">测试发现，如果碰到空地址,比如这个h[3]，会进入一段时间死循环。。。果不其然</span></span><br><span class="line"><span class="comment">//自己应该是在指针的理解上出现了一些问题，得去攻读下o'reilly的《深入理解c指针》了 */</span></span><br><span class="line"> </span><br><span class="line">                 <span class="comment">//Not effective???</span></span><br><span class="line">                 </span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">20</span>;j++)                  <span class="comment">//对了，每一列指数值不一定相同的吖！ </span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!h[j+<span class="number">1</span>])<span class="comment">//原来是你把我辛辛苦苦生成的结果的头指针给改了的#.#</span></span><br><span class="line">        &#123;</span><br><span class="line">            head=h[j];</span><br><span class="line"><span class="keyword">break</span>;<span class="comment">//不，不是它的错，是下面的Pc-&gt;next出现了两个-1指数项！</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//printPolyn(h[j+1]);</span></span><br><span class="line">AddPolyn_multi(h[j+<span class="number">1</span>],h[j]);</span><br><span class="line">head=h[j+<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// qc-&gt;next=qa?qa:qb;</span></span><br><span class="line">Pc-&gt;next=head;<span class="comment">//擦!你丫蛋没初始化就跑进来了</span></span><br><span class="line"><span class="comment">//free(Pb);/*乘法部分逻辑上是没什么问题的咯，问题应该是出现在构造加法那里，哪里没有接上 */</span></span><br><span class="line">&#125;<span class="comment">//（后来补充）看来不是构造加法问题</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">diff</span><span class="params">(polynomial Pa, polynomial Pb)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LinkList qa=Pa-&gt;next;</span><br><span class="line">LinkList head;</span><br><span class="line"></span><br><span class="line">Pb-&gt;coef=<span class="number">0.0</span>;</span><br><span class="line">Pb-&gt;expn=<span class="number">-1</span>;</span><br><span class="line">Pb-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">head=Pb;</span><br><span class="line"><span class="comment">//Pb=Pb-&gt;next;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(qa)</span><br><span class="line">&#123;</span><br><span class="line">Pb-&gt;next=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">         <span class="comment">//  if(!Pb-&gt;next) exit(OVERFLOW);</span></span><br><span class="line">Pb=Pb-&gt;next;</span><br><span class="line">Pb-&gt;coef=(qa-&gt;coef)*(<span class="keyword">float</span>)(qa-&gt;expn);                <span class="comment">//coef和expn类型不同，需要进行类型转化</span></span><br><span class="line">Pb-&gt;expn=qa-&gt;expn<span class="number">-1</span>;</span><br><span class="line">Pb-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Pb=head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">polynomial Pa;</span><br><span class="line">polynomial Pb;</span><br><span class="line">polynomial Pc;</span><br><span class="line">polynomial Pd;</span><br><span class="line">Pa=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">Pb=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">Pc=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line"><span class="comment">//Pc-&gt;next=NULL;</span></span><br><span class="line">Pd=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line"><span class="comment">//Pd-&gt;next=NULL;</span></span><br><span class="line"></span><br><span class="line">CreatePolyn(Pa);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Pa="</span>);</span><br><span class="line">printPolyn(Pa);</span><br><span class="line">CreatePolyn(Pb);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Pb="</span>);</span><br><span class="line">printPolyn(Pb);</span><br><span class="line"><span class="comment">/*Pc = Pa;</span></span><br><span class="line"><span class="comment">Pd = Pb;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\nPa'="</span>);</span><br><span class="line">diff(Pa,Pc);</span><br><span class="line">printPolyn(Pc);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Pa+Pb="</span>);</span><br><span class="line">AddPolyn(Pa,Pb,Pc);</span><br><span class="line">printPolyn(Pc);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Pa-Pb="</span>);</span><br><span class="line">SubPolyn(Pa,Pb,Pc);</span><br><span class="line">printPolyn(Pc);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Pa*Pb="</span>);</span><br><span class="line">MultiPolyn(Pa,Pb,Pd);</span><br><span class="line">printPolyn(Pd);</span><br><span class="line"><span class="comment">//printf("\n");</span></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*printf("Pb'=");</span></span><br><span class="line"><span class="comment">diff(Pb,Pc);</span></span><br><span class="line"><span class="comment">printPolyn(Pc);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="实现代码-纯净版-："><a href="#实现代码-纯净版-：" class="headerlink" title="实现代码(纯净版)："></a>实现代码(纯净版)：</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">term</span>&#123;</span></span><br><span class="line"><span class="keyword">float</span> coef;</span><br><span class="line"><span class="keyword">int</span> expn;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">term</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;term,*LinkList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> LinkList polynomial;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(LinkList pa,LinkList pb)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(pa-&gt;expn &gt; pb-&gt;expn)</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(pa-&gt;expn == pb-&gt;expn)</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LocateElem</span><span class="params">(LinkList L,LinkList t,LinkList *q)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LinkList p1=L-&gt;next;</span><br><span class="line">LinkList p2=L;</span><br><span class="line"><span class="keyword">while</span>(p1)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(t-&gt;expn &gt; p1-&gt;expn)</span><br><span class="line">&#123;</span><br><span class="line">p1=p1-&gt;next;</span><br><span class="line">p2=p2-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(t-&gt;expn == p1-&gt;expn)</span><br><span class="line">&#123;</span><br><span class="line">*q=p1;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line">*q=p2;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">*q=p2;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CreatePolyn</span><span class="params">(polynomial P)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LinkList t;</span><br><span class="line">LinkList q;</span><br><span class="line">P-&gt;coef=<span class="number">0.0</span>;</span><br><span class="line">P-&gt;expn=<span class="number">-1</span>;</span><br><span class="line">P-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Please input coefficient and exponent in format like 1,2 and end with 0,0 :\n"</span>);</span><br><span class="line"></span><br><span class="line">t=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">t-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%f,%d"</span>,&amp;t-&gt;coef,&amp;t-&gt;expn);</span><br><span class="line"><span class="keyword">while</span>(t-&gt;coef||t-&gt;expn)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!LocateElem(P,t,&amp;q))</span><br><span class="line">&#123;</span><br><span class="line">t-&gt;next=q-&gt;next;</span><br><span class="line">q-&gt;next=t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">t=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">t-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%f,%d"</span>,&amp;t-&gt;coef,&amp;t-&gt;expn);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printPolyn</span><span class="params">(polynomial P)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LinkList q;</span><br><span class="line">q=P-&gt;next;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!q)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"0\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(q)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(q-&gt;coef==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">""</span>);</span><br><span class="line">q=q-&gt;next;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(q-&gt;expn==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.2f"</span>,q-&gt;coef);</span><br><span class="line">q=q-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(q-&gt;expn&gt;<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.2f*x^%d"</span>,q-&gt;coef,q-&gt;expn);</span><br><span class="line">q=q-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.2f*x^(%d)"</span>,q-&gt;coef,q-&gt;expn);</span><br><span class="line">q=q-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(q)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(q-&gt;coef&gt;<span class="number">0</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"+"</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddPolyn</span><span class="params">(polynomial Pa,polynomial Pb,polynomial Pc)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LinkList qa=Pa-&gt;next;</span><br><span class="line">LinkList qb=Pb-&gt;next;</span><br><span class="line">LinkList qc=Pc;</span><br><span class="line">LinkList head=qc;</span><br><span class="line">LinkList s;</span><br><span class="line"><span class="keyword">float</span> sum;</span><br><span class="line"></span><br><span class="line">Pc-&gt;coef=<span class="number">0.0</span>;</span><br><span class="line">Pc-&gt;expn=<span class="number">-1</span>;</span><br><span class="line">Pc-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(qa&amp;&amp;qb)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">switch</span>(cmp(qa,qb))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">-1</span>:</span><br><span class="line">s=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">*s=*qa;</span><br><span class="line">qc-&gt;next=s;</span><br><span class="line">qc=s;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">sum=qa-&gt;coef+qb-&gt;coef;</span><br><span class="line"><span class="keyword">if</span>(sum!=<span class="number">0.0</span>)</span><br><span class="line">&#123;</span><br><span class="line">s=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">*s=*qa;</span><br><span class="line">s-&gt;coef=sum;</span><br><span class="line">qc-&gt;next=s;</span><br><span class="line">qc=s;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">qc-&gt;next=qa-&gt;next;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">s=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">*s=*qb;</span><br><span class="line">qc-&gt;next=s;</span><br><span class="line">qc=s;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">qc-&gt;next=qa?qa:qb;</span><br><span class="line">Pc=head;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SubPolyn</span><span class="params">(polynomial Pa,polynomial Pb,polynomial Pc)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LinkList qa=Pa-&gt;next;</span><br><span class="line">LinkList qb=Pb-&gt;next;</span><br><span class="line">LinkList qc=Pc;</span><br><span class="line">LinkList head=qc;</span><br><span class="line">LinkList s;</span><br><span class="line"><span class="keyword">float</span> differ;</span><br><span class="line"></span><br><span class="line">Pc-&gt;coef=<span class="number">0.0</span>;</span><br><span class="line">Pc-&gt;expn=<span class="number">-1</span>;</span><br><span class="line">Pc-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(qb)</span><br><span class="line">&#123;</span><br><span class="line">qb-&gt;coef=<span class="number">0</span>-(qb-&gt;coef);</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">qb=Pb-&gt;next;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(qa&amp;&amp;qb)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">switch</span>(cmp(qa,qb))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">-1</span>:</span><br><span class="line">s=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">*s=*qa;</span><br><span class="line">qc-&gt;next=s;</span><br><span class="line">qc=s;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">differ=qa-&gt;coef+qb-&gt;coef;</span><br><span class="line"><span class="keyword">if</span>(differ!=<span class="number">0.0</span>)</span><br><span class="line">&#123;</span><br><span class="line">s=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">*s=*qa;</span><br><span class="line">s-&gt;coef=differ;</span><br><span class="line">qc-&gt;next=s;</span><br><span class="line">qc=s;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">qc-&gt;next=qa-&gt;next;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">s=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">*s=*qb;</span><br><span class="line">qc-&gt;next=s;</span><br><span class="line">qc=s;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">qc-&gt;next=qa?qa:qb;</span><br><span class="line">Pc=head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">diff</span><span class="params">(polynomial Pa,polynomial Pb)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LinkList qa=Pa-&gt;next;</span><br><span class="line">LinkList head;</span><br><span class="line">Pb-&gt;coef=<span class="number">0.0</span>;</span><br><span class="line">Pb-&gt;expn=<span class="number">-1</span>;</span><br><span class="line">Pb-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">head=Pb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(qa)</span><br><span class="line">&#123;</span><br><span class="line">Pb-&gt;next=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">Pb=Pb-&gt;next;</span><br><span class="line">Pb-&gt;coef=(qa-&gt;coef)*(<span class="keyword">float</span>)(qa-&gt;expn);</span><br><span class="line">Pb-&gt;expn=qa-&gt;expn<span class="number">-1</span>;</span><br><span class="line">Pb-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Pb=head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddPolyn_multi</span><span class="params">(polynomial Pa,polynomial Pb)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LinkList qa=Pa-&gt;next;</span><br><span class="line">LinkList qb=Pb-&gt;next;</span><br><span class="line">LinkList qc=qa;</span><br><span class="line">LinkList head=qc;</span><br><span class="line">LinkList s,s1,s2;</span><br><span class="line"><span class="keyword">float</span> sum;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(qa&amp;&amp;qb)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">switch</span>(cmp(qa,qb))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">-1</span>:</span><br><span class="line">qc-&gt;next=qa;</span><br><span class="line">qc=qa;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">sum=qa-&gt;coef+qb-&gt;coef;</span><br><span class="line"><span class="keyword">if</span>(sum!=<span class="number">0.0</span>)</span><br><span class="line">&#123;</span><br><span class="line">s=qb;</span><br><span class="line">qa-&gt;coef=sum;</span><br><span class="line">qc-&gt;next=qa;</span><br><span class="line">qc=qa;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"><span class="built_in">free</span>(s);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">s1=qa;</span><br><span class="line">s2=qb;</span><br><span class="line">qc-&gt;next=qa-&gt;next;</span><br><span class="line">qa=qa-&gt;next;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"><span class="built_in">free</span>(s1);</span><br><span class="line"><span class="built_in">free</span>(s2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">qc-&gt;next=qb;</span><br><span class="line">qc=qb;</span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">qc-&gt;next=qa?qa:qb;</span><br><span class="line">Pa=head;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MultiPolyn</span><span class="params">(polynomial Pa,polynomial Pb,polynomial Pc)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LinkList qa=Pa-&gt;next;</span><br><span class="line">LinkList qb=Pb-&gt;next;</span><br><span class="line">LinkList head;</span><br><span class="line">LinkList qd;</span><br><span class="line">LinkList t[<span class="number">20</span>],d[<span class="number">20</span>],h[<span class="number">20</span>];</span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"></span><br><span class="line">Pc-&gt;coef=<span class="number">0.0</span>;</span><br><span class="line">Pc-&gt;expn=<span class="number">-1</span>;</span><br><span class="line">Pc-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(qa&amp;&amp;qb)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">20</span>;j++)</span><br><span class="line">&#123;</span><br><span class="line">d[j]=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">d[j]-&gt;coef=<span class="number">0.0</span>;</span><br><span class="line">d[j]-&gt;expn=<span class="number">-1</span>;</span><br><span class="line">d[j]-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">h[j]=d[j];</span><br><span class="line">qd=qa;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">20</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">t[i]=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">*t[i]=*qd;</span><br><span class="line">t[i]-&gt;coef=(qd-&gt;coef)*(qb-&gt;coef)*(<span class="number">-1</span>);</span><br><span class="line">t[i]-&gt;expn=qd-&gt;expn+qb-&gt;expn;</span><br><span class="line">d[j]-&gt;next=t[i];</span><br><span class="line">d[j]=t[i];</span><br><span class="line">qd=qd-&gt;next;</span><br><span class="line"><span class="keyword">if</span>(!qd)</span><br><span class="line">&#123;</span><br><span class="line">d[j]-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">qb=qb-&gt;next;</span><br><span class="line"><span class="keyword">if</span>(!qb)</span><br><span class="line">&#123;</span><br><span class="line">h[j+<span class="number">1</span>]=<span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">20</span>;j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!h[j+<span class="number">1</span>])</span><br><span class="line">&#123;</span><br><span class="line">head=h[j];</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">AddPolyn_multi(h[j+<span class="number">1</span>],h[j]);</span><br><span class="line">head=h[j+<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Pc-&gt;next=head;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">polynomial Pa;</span><br><span class="line">polynomial Pb;</span><br><span class="line">polynomial Pc;</span><br><span class="line">polynomial Pd;</span><br><span class="line">Pa=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">Pb=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line">Pc=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line"></span><br><span class="line">Pd=(LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(term));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CreatePolyn(Pa);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Pa="</span>);</span><br><span class="line">printPolyn(Pa);</span><br><span class="line">CreatePolyn(Pb);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Pb="</span>);</span><br><span class="line">printPolyn(Pb);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\nPa'="</span>);</span><br><span class="line">diff(Pa,Pc);</span><br><span class="line">printPolyn(Pc);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Pa+Pb="</span>);</span><br><span class="line">AddPolyn(Pa,Pb,Pc);</span><br><span class="line">printPolyn(Pc);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Pa-Pb="</span>);</span><br><span class="line">SubPolyn(Pa,Pb,Pc);</span><br><span class="line">printPolyn(Pc);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Pa*Pb="</span>);</span><br><span class="line">MultiPolyn(Pa,Pb,Pd);</span><br><span class="line">printPolyn(Pd);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="运行结果："><a href="#运行结果：" class="headerlink" title="运行结果："></a>运行结果：</h4><p><img src="https://i.loli.net/2019/01/11/5c38b57227e64.png" alt="1543085198024.png" title="1543085198024.png"></p><h4 id="参考文章："><a href="#参考文章：" class="headerlink" title="参考文章："></a>参考文章：</h4><blockquote><p><a href="https://blog.csdn.net/qq_18677011/article/details/60590564" target="_blank" rel="noopener">利用单链表实现一元多项式的表示及相加</a></p><p><a href="https://blog.csdn.net/lijgcn/article/details/62247927" target="_blank" rel="noopener">有序链表一元多项式C实例</a></p><p><a href="https://stackoverflow.com/questions/18162340/polynomial-multiplication-using-linked-list-in-c" target="_blank" rel="noopener">Polynomial multiplication using linked list in C</a></p></blockquote><p><img src="https://i.loli.net/2019/01/11/5c38b58ad9cf5.jpg" alt="3.coyote.jpg" title="3.coyote.jpg"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;利用链表实现一元多项式的数学运算。如一元多项式 &lt;/p&gt;
&lt;img src=&quot;/2018/11/03/A-C-algorithm-with-linked-list-to-express-addition-subtraction-multiplication-differential-of-polynomial/1543086464267.png&quot; title=&quot;This is an example image&quot;&gt;
&lt;p&gt;可以利用其系数p和指数e组合的方式实现链式存储。通过对线性表的基本操&lt;br&gt;作，例如插入，删除，查找等可以实现一元多项式的复杂运算，比如加，减，&lt;br&gt;乘，除等运算。 &lt;/p&gt;
    
    </summary>
    
    
      <category term="算法" scheme="http://lesliewong.cn/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="算法" scheme="http://lesliewong.cn/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>约瑟夫环问题的C语言算法实现</title>
    <link href="http://lesliewong.cn/2018/10/25/A-C-algorithm-to-solve-the-Joseph-Ring-problem/"/>
    <id>http://lesliewong.cn/2018/10/25/A-C-algorithm-to-solve-the-Joseph-Ring-problem/</id>
    <published>2018-10-25T11:35:04.000Z</published>
    <updated>2019-01-13T01:56:42.672Z</updated>
    
    <content type="html"><![CDATA[<hr><p>约瑟夫(Joseph)问题的一种描述是：编号为 1，2，…..，n 的 n 个人按顺时针方向围坐一圈，每人持有一个密码（正整数）。一开始任选一个正整数作为报数上限值 m，从第一个人开始按顺时针方向自 1 开始顺序报数，报到 m 时停止报数。报 m 的人出列，将他的密码作为新的 m 值，从他在顺时针方 向上的下一个人开始重新从 1 报数，如此下去，直至所有人全部出列为止。试设计一个程序求出出列顺序。 </p><a id="more"></a><h4 id="基本要求"><a href="#基本要求" class="headerlink" title="基本要求"></a>基本要求</h4><p>利用单向循环链表存储结构模拟此过程，按照出列的顺序印出各人的编号。 </p><h4 id="测试数据"><a href="#测试数据" class="headerlink" title="测试数据"></a>测试数据</h4><p>n=7, 7 个人的密码依次为：3，1，7，2，4，8，4，首先 m 值为 6（正 确的出列顺序应为 6，1，4，7，2，3，5），输出的密码为 8，3，2，4，1， 7，4. </p><h4 id="实现提示"><a href="#实现提示" class="headerlink" title="实现提示"></a>实现提示</h4><p>程序运行后，首先要求用户指定初始报数上限值，然后读取各人的密 码。可设 n&lt;=30。此题所用的循环链表中不需要“头节点”，请注意空表和非空表的界限。</p><h5 id="算法代码："><a href="#算法代码：" class="headerlink" title="算法代码："></a>算法代码：</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LEN sizeof(struct Student)</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span>//用链表建立学生数据类型</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> number;</span><br><span class="line"><span class="keyword">int</span> password;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">struct Student *<span class="title">creat</span><span class="params">(<span class="keyword">void</span>)</span><span class="comment">//输入具体学生信息，约定0,0结束</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> *<span class="title">head</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> *<span class="title">p1</span>,*<span class="title">p2</span>;</span></span><br><span class="line"><span class="keyword">int</span> n=<span class="number">0</span>;</span><br><span class="line">p1=p2=(struct Student *)<span class="built_in">malloc</span>(LEN);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d,%d"</span>,&amp;p1-&gt;number,&amp;p1-&gt;password);</span><br><span class="line">head=<span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">while</span>(p1-&gt;number!=<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">n=n+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(n==<span class="number">1</span>)head=p1;</span><br><span class="line"><span class="keyword">else</span> p2-&gt;next=p1;</span><br><span class="line">p2=p1;</span><br><span class="line">p1=(struct Student *)<span class="built_in">malloc</span>(LEN);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d,%d"</span>,&amp;p1-&gt;number,&amp;p1-&gt;password);</span><br><span class="line">&#125;</span><br><span class="line">p2-&gt;next=head;</span><br><span class="line"><span class="keyword">return</span>(head);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Joseph</span><span class="params">(struct Student *head,<span class="keyword">int</span> count)</span>    <span class="comment">//游戏环节，按照约瑟夫环规则运行，并输出结果</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> *<span class="title">p</span>;</span></span><br><span class="line">p=head;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(m=<span class="number">1</span>;m&lt;count<span class="number">-1</span>;m++)</span><br><span class="line">p=p-&gt;next;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d,%d\n"</span>,(p-&gt;next)-&gt;number,(p-&gt;next)-&gt;password);</span><br><span class="line">count=p-&gt;next-&gt;password;</span><br><span class="line">p-&gt;next=p-&gt;next-&gt;next;</span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line"><span class="keyword">for</span>(m=<span class="number">1</span>;m&lt;count;m++)</span><br><span class="line">p=p-&gt;next;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d,%d\n"</span>,(p-&gt;next)-&gt;number,(p-&gt;next)-&gt;password);</span><br><span class="line">count=p-&gt;next-&gt;password;</span><br><span class="line">p-&gt;next=p-&gt;next-&gt;next;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">while</span>(p!=p-&gt;next);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d,%d\n"</span>,p-&gt;number,p-&gt;password);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span><span class="comment">//主函数，输入学生信息和上限值 </span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> *<span class="title">Head</span>;</span></span><br><span class="line"><span class="keyword">int</span> num;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"请输入个人的序号和密码：\n"</span>);</span><br><span class="line">Head=creat();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"请指定初始报数上限值：\n"</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;num);</span><br><span class="line">Joseph(Head,num);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="运行结果："><a href="#运行结果：" class="headerlink" title="运行结果："></a>运行结果：</h5><p><img src="https://i.loli.net/2019/01/11/5c38b34655d70.jpg" alt="Joseph运行结果.jpg" title="Joseph运行结果.jpg"></p><hr><p><img src="https://i.loli.net/2019/01/11/5c38b36d83454.jpg" alt="2.cat.jpg" title="2.cat.jpg"></p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;p&gt;约瑟夫(Joseph)问题的一种描述是：编号为 1，2，…..，n 的 n 个人按顺时针方向围坐一圈，每人持有一个密码（正整数）。一开始任选一个正整数作为报数上限值 m，从第一个人开始按顺时针方向自 1 开始顺序报数，报到 m 时停止报数。报 m 的人出列，将他的密码作为新的 m 值，从他在顺时针方 向上的下一个人开始重新从 1 报数，如此下去，直至所有人全部出列为止。试设计一个程序求出出列顺序。 &lt;/p&gt;
    
    </summary>
    
    
      <category term="算法" scheme="http://lesliewong.cn/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="算法" scheme="http://lesliewong.cn/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>CSS中伪元素的定位上下文问题</title>
    <link href="http://lesliewong.cn/2018/09/10/A-doubt-about-the-pseudo-element-in-CSS/"/>
    <id>http://lesliewong.cn/2018/09/10/A-doubt-about-the-pseudo-element-in-CSS/</id>
    <published>2018-09-10T12:08:12.000Z</published>
    <updated>2019-01-13T01:56:18.164Z</updated>
    
    <content type="html"><![CDATA[<hr><p>在研究CSS名著《CSS设计指南》（第3版）中，对讲到界面组件中的用CSS为弹出层设计三角形这个知识点时，对例子代码中伪元素的定位上下文关系产生了很大的困惑。</p><a id="more"></a><hr><h4 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="selector-tag">DOCTYPE</span> <span class="selector-tag">html</span>&gt;</span><br><span class="line">&lt;<span class="selector-tag">html</span>&gt;</span><br><span class="line">&lt;<span class="selector-tag">head</span>&gt;</span><br><span class="line">&lt;meta charset="utf-8" /&gt; </span><br><span class="line">&lt;title&gt;Stylin' with CSS - Figure 6.24 Popup Overlay&lt;/title&gt;</span><br><span class="line">&lt;<span class="selector-tag">style</span>&gt;</span><br><span class="line">* &#123;<span class="attribute">margin</span>:<span class="number">0</span>; <span class="attribute">padding</span>:<span class="number">0</span>; <span class="attribute">font-family</span>:helvetica, arial, sans-serif;&#125;</span><br><span class="line"><span class="selector-tag">figure</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">144px</span>; <span class="attribute">height</span>:<span class="number">153px</span>; <span class="comment">/* sizing of image box */</span></span><br><span class="line">    <span class="attribute">margin</span>:<span class="number">20px</span> <span class="number">20px</span>;            <span class="comment">/* space between boxes */</span></span><br><span class="line">    <span class="attribute">border</span>:<span class="number">1px</span> solid <span class="number">#666</span>;        <span class="comment">/* image border */</span></span><br><span class="line">    <span class="attribute">position</span>:relative; <span class="comment">/* positioning context for popups */</span></span><br><span class="line">    <span class="attribute">float</span>:left; <span class="comment">/* makes images sit side by side */</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="selector-tag">img</span> &#123;<span class="attribute">display</span>:block;&#125;<span class="comment">/* remove baseline spacing from under image */</span></span><br><span class="line"><span class="selector-tag">figcaption</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>:none; <span class="comment">/* hides popups */</span></span><br><span class="line">    <span class="attribute">position</span>:absolute; <span class="comment">/* relative to images */</span></span><br><span class="line">    <span class="attribute">left</span>:<span class="number">74%</span>; <span class="attribute">top</span>:<span class="number">14px</span>; <span class="comment">/* positions popup on right side of image */</span></span><br><span class="line">    <span class="attribute">width</span>:<span class="number">130px</span>; <span class="comment">/* width of popup */</span></span><br><span class="line">    <span class="attribute">padding</span>:<span class="number">10px</span>; <span class="comment">/* space around popup content */</span></span><br><span class="line">    <span class="attribute">background</span>:<span class="number">#f2eaea</span>;</span><br><span class="line">    <span class="attribute">border</span>:<span class="number">3px</span> solid red; <span class="attribute">border-radius</span>:<span class="number">6px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="selector-tag">figure</span><span class="selector-pseudo">:hover</span> <span class="selector-tag">figcaption</span> &#123;<span class="attribute">display</span>:block; <span class="attribute">z-index</span>:<span class="number">2</span>;&#125; <span class="comment">/* displays popup when image is hovered */</span></span><br><span class="line"><span class="selector-tag">figcaption</span> <span class="selector-tag">h3</span> &#123; <span class="comment">/* popup content */</span></span><br><span class="line">    <span class="attribute">font-size</span>:<span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">color</span>:<span class="number">#666</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>:<span class="number">6px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="selector-tag">figcaption</span> <span class="selector-tag">a</span> &#123; <span class="comment">/* popup content */</span></span><br><span class="line">    <span class="attribute">display</span>:block;</span><br><span class="line">    <span class="attribute">text-decoration</span>:none;</span><br><span class="line">    <span class="attribute">font-size</span>:<span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">color</span>:<span class="number">#000</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="selector-tag">figcaption</span><span class="selector-pseudo">::after</span> &#123; <span class="comment">/* red triangle box*/</span></span><br><span class="line">    <span class="attribute">content</span>:<span class="string">""</span>; <span class="comment">/* some content required - using empty text string */</span></span><br><span class="line">    <span class="attribute">position</span>:absolute; <span class="comment">/* relative to popup */</span></span><br><span class="line">    <span class="attribute">border</span>:<span class="number">12px</span> solid;</span><br><span class="line">    <span class="attribute">border-color</span>:transparent red transparent transparent; </span><br><span class="line">    <span class="attribute">right</span>:<span class="number">100%</span>; <span class="attribute">top</span>:<span class="number">17px</span>;</span><br><span class="line">    <span class="attribute">height</span>:<span class="number">0px</span>; <span class="attribute">width</span>:<span class="number">0px</span>; <span class="comment">/* collapses box to create triangle */</span> </span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="selector-tag">body</span>&gt;</span><br><span class="line">    &lt;<span class="selector-tag">figure</span>&gt;</span><br><span class="line">        &lt;img src="images/pink_heels.jpg" alt="pink heels" /&gt;</span><br><span class="line">        &lt;<span class="selector-tag">figcaption</span>&gt;</span><br><span class="line">            &lt;h3&gt;Pink Platforms&lt;/h3&gt;</span><br><span class="line">            &lt;a href="#"&gt;More info&lt;/a&gt;</span><br><span class="line">        &lt;/figcaption&gt;</span><br><span class="line">    &lt;/figure&gt;</span><br><span class="line">    &lt;figure class="click_me"&gt;</span><br><span class="line">        &lt;img src="images/leopard_heels.jpg" alt="leopard heels" /&gt;</span><br><span class="line">        &lt;<span class="selector-tag">figcaption</span>&gt;</span><br><span class="line">            &lt;h3&gt;Leopard Platforms&lt;/h3&gt;</span><br><span class="line">            &lt;a href="#"&gt;More info&lt;/a&gt;</span><br><span class="line">        &lt;/figcaption&gt;</span><br><span class="line">    &lt;/figure&gt;</span><br><span class="line">    &lt;figure class="click_me"&gt;</span><br><span class="line">        &lt;img src="images/red_heels.jpg" alt="red heels" /&gt;</span><br><span class="line">        &lt;<span class="selector-tag">figcaption</span>&gt;</span><br><span class="line">            &lt;h3&gt;Red Platforms&lt;/h3&gt;</span><br><span class="line">            &lt;a href="#"&gt;More info&lt;/a&gt;</span><br><span class="line">        &lt;/figcaption&gt;</span><br><span class="line">    &lt;/figure&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- OK to remove the code between here and &lt;/body&gt; --&gt;</span><br><span class="line">    &lt;!-- Please note that the watermarked image/images in this code example is/are provided only for the purpose of displaying the code example in your browser. Licensing rights to this image/images is/are not conveyed to you. If you would like to purchase licensing rights for the images in this book, please visit the following url: --&gt; </span><br><span class="line">    &lt;div style="clear:both; padding:100px 0 0 0; font-size:.85em; color:#666;"&gt;</span><br><span class="line">    &lt;p&gt;To purchase the stock images in this book and other great stock images, go to &lt;a href="http://www.bigstockphoto.com/?refid=PEECNmwgKb"&gt;bigstockphoto.com&lt;/a&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;A code example from &lt;em&gt;Stylin&amp;rsquo; with CSS, Third Edition&lt;/em&gt; by Charles Wyke-Smith. Visit &lt;a href="http://www.stylinwithcss.com"&gt;stylinwithcss.com&lt;/a&gt; for more CSS information and updates.&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    </span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><hr><p>浏览器渲染后的效果如下：</p><p><img src="https://i.loli.net/2019/01/11/5c38a36b93191.jpg" alt="1.jpg" title="1.jpg"></p><hr><p>文字说明框在鼠标悬浮于图片上时出现，同时框左边会出现由于边框透明原理而生出的三角形。具体原理代码如下：</p><hr><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">figcaption</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>:none; <span class="comment">/* hides popups */</span></span><br><span class="line">    <span class="attribute">position</span>:absolute; <span class="comment">/* relative to images */</span></span><br><span class="line">    <span class="attribute">left</span>:<span class="number">74%</span>; <span class="attribute">top</span>:<span class="number">14px</span>; <span class="comment">/* positions popup on right side of image */</span></span><br><span class="line">    <span class="attribute">width</span>:<span class="number">130px</span>; <span class="comment">/* width of popup */</span></span><br><span class="line">    <span class="attribute">padding</span>:<span class="number">10px</span>; <span class="comment">/* space around popup content */</span></span><br><span class="line">    <span class="attribute">background</span>:<span class="number">#f2eaea</span>;</span><br><span class="line">    <span class="attribute">border</span>:<span class="number">3px</span> solid red; <span class="attribute">border-radius</span>:<span class="number">6px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="selector-tag">figure</span><span class="selector-pseudo">:hover</span> <span class="selector-tag">figcaption</span> &#123;<span class="attribute">display</span>:block; <span class="attribute">z-index</span>:<span class="number">2</span>;&#125; <span class="comment">/* displays popup when image is hovered */</span></span><br><span class="line"><span class="selector-tag">figcaption</span><span class="selector-pseudo">::after</span> &#123; <span class="comment">/* red triangle box*/</span></span><br><span class="line">    <span class="attribute">content</span>:<span class="string">""</span>; <span class="comment">/* some content required - using empty text string */</span></span><br><span class="line">    <span class="attribute">position</span>:absolute; <span class="comment">/* relative to popup */</span></span><br><span class="line">    <span class="attribute">border</span>:<span class="number">12px</span> solid;</span><br><span class="line">    <span class="attribute">border-color</span>:transparent red transparent transparent; </span><br><span class="line">    <span class="attribute">right</span>:<span class="number">100%</span>; <span class="attribute">top</span>:<span class="number">17px</span>;</span><br><span class="line">    <span class="attribute">height</span>:<span class="number">0px</span>; <span class="attribute">width</span>:<span class="number">0px</span>; <span class="comment">/* collapses box to create triangle */</span> </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><hr><p>根据《CSS设计指南（第3版）》中对定位上下文的解释，</p><blockquote><p>在讲绝对定位的时候，我们知道绝对定位元素默认的定位上下文是body。这是因为body是标记中所有元素唯一的祖先元素。而实际上，绝对定位元素的任何祖先元素都可以成为它的定位上下文，只要你把相应祖先元素的position设定为relative即可。</p><p>​                                    ——P91,人民邮电出版社，《CSS设计指南（第3版）》</p></blockquote><hr><p>可是位于书中第226页的例子代码中（如上）却出现了不太符合这种逻辑的情况。用伪元素法生成的红色三角形是相对position属性为absolute的figcaption（即弹出文字框）作移动，而不是相对position属性为relative的祖先元素figure。</p><p>自己目前还是不太明白，是因为出现了hove的缘故？亦或 原先的定位上下文的规则不太适用于伪元素？</p><p>依旧求解中。</p><hr><p>(2018.9.15更新)</p><p>对于这个问题的答案，自己姑且只能采取经验总结的方式了，总结认为伪元素::before和::after创建后position设置为absolute其位置移动属性是相对于设置自己的最近元素的。</p><p>参考了MDN文档中对::after和::before的解释，其中::before解释中出现了与此情况类似的代码。</p><h3 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Buy milk<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Take the dog for a walk<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Exercise<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Write code<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Play music<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Relax<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">li</span> &#123;</span><br><span class="line">  <span class="attribute">list-style-type</span>: none;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">2px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0.5em</span> <span class="number">0.5em</span> <span class="number">0.5em</span> <span class="number">2em</span>;</span><br><span class="line">  <span class="attribute">background</span>: lightgrey;</span><br><span class="line">  <span class="attribute">font-family</span>: sans-serif;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">li</span><span class="selector-class">.done</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#CCFF99</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">li</span><span class="selector-class">.done</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">''</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#009933</span>;</span><br><span class="line">  <span class="attribute">border-style</span>: solid;</span><br><span class="line">  <span class="attribute">border-width</span>: <span class="number">0</span> <span class="number">0.3em</span> <span class="number">0.25em</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">1em</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">1.3em</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0.6em</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">1em</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate</span>(45deg);</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0.5em</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> list = <span class="built_in">document</span>.querySelector(<span class="string">'ul'</span>);</span><br><span class="line">list.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">ev</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>( ev.target.tagName === <span class="string">'LI'</span>) &#123;</span><br><span class="line">     ev.target.classList.toggle(<span class="string">'done'</span>); </span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure><h3 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h3><hr><p>点击前:</p><p><img src="https://i.loli.net/2019/01/11/5c38a36b92892.jpg" alt="2.jpg" title="2.jpg"></p><p>点击后:</p><p><img src="https://i.loli.net/2019/01/11/5c38a36b92e11.jpg" alt="3.jpg" title="3.jpg"></p><hr><p>可以看到这个例子代码也给before伪元素设置了移动属性top和left,然而——–，可是——，   它的父元素 li 是堂堂正正地设置为position:relative; 的吖。。。</p><p>目前看来也只能总结成自己的踩坑经验了，给定位上下文这个知识点补充一些例外。</p><hr><p><img src="https://i.loli.net/2019/01/11/5c38a36b93476.jpg" alt="1.grizzlyBear.jpg" title="1.grizzlyBear.jpg"></p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;p&gt;在研究CSS名著《CSS设计指南》（第3版）中，对讲到界面组件中的用CSS为弹出层设计三角形这个知识点时，对例子代码中伪元素的定位上下文关系产生了很大的困惑。&lt;/p&gt;
    
    </summary>
    
    
      <category term="前端" scheme="http://lesliewong.cn/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="前端" scheme="http://lesliewong.cn/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
</feed>
